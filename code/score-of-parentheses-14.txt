int scoreOfParentheses(string s) {
  stack<int> retain;
  int score = 0;
  for (char c : s) {
	if (c == '(') {
	  retain.push(score);  // retain all score before '('
	  score = 0;
	} else {  
	  score = retain.top() + max(score * 2, 1);  // score before '('  + now score=max(score * 2, 1)
	  retain.pop();
	}
  }
  return score;
}
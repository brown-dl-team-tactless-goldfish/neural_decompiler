class Solution {
public:
    int minimizeTheDifference(vector<vector<int>>& mat, int target) {
        int n = mat.size();
        int m = mat[0].size();
        bool v[801][2] = {0};
        v[0][0] = 1;
        int mt = 1000000;
        for(int i=n-1; i>=0; i--)
        {
            mt = mt + (*min_element(mat[i].begin(),mat[i].end()));
            for(int k=0; k<=target; k++)
            {
                if (v[k][0])
                {
                    for(int j=0; j<m; j++)
                    {
                        if (mat[i][j] + k <= target)
                            v[mat[i][j] + k][1] = true;
                        else
                            mt = min(mt, mat[i][j] + k);
                    }
                }
            }
            for(int i=0; i<=target; i++) 
            {
                v[i][0] = v[i][1];
                v[i][1] = false;
            }
        }
        int ans = mt - target; 
        for(int i=0; i<=target; i++)  
        {
            if (v[i][0])
                ans = min(ans, target-i);
        }
        return ans;
    }
};
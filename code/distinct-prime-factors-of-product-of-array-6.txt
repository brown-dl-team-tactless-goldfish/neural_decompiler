public class Solution 
{
    public int DistinctPrimeFactors(int[] nums) 
    {
        HashSet<int> pFactors = new HashSet<int>();
        foreach (int num in nums)
        {
            int numValue = num;
            for (int i = 2; numValue > 1; i++)
            {
                if (numValue % i == 0)
                {
                    pFactors.Add(i);
                    while (numValue % i == 0)
                    {
                        numValue /= i;
                    }
                }
            }
        }
        return pFactors.Count;
    }
}
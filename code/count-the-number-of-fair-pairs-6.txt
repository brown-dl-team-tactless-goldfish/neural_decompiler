class Solution {
public:
    long long countFairPairs(vector<int>& nums, int lower, int upper) {
        long long ans = 0;
        deque<int> q;
        int n = nums.size();
        sort(nums.begin() , nums.end());

        for(auto it:nums){
            q.push_back(it);
        }

        for(int i=0 ; i<n ; i++){
            q.pop_front();
             int first = lower-nums[i] , last = upper-nums[i];
             auto left = lower_bound(q.begin() , q.end() , first);
             auto right = upper_bound(q.begin() , q.end() , last);
             ans += right-left;
        }
        return ans;
    }
};
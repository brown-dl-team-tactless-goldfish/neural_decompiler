public class Solution {
    public int[][] SpiralMatrixIII(int R, int C, int r0, int c0) {
        var res = new int[R * C][];

        int cur = 0, len = 1;

        while (cur < R * C)
        {
            for (var i = c0; i < c0 + len; i++) if (i >= 0 && i < C && r0 >= 0 && r0 < R) res[cur++] = new[] { r0, i };

            c0 += len;

            for (var i = r0; i < r0 + len; i++) if (c0 < C && c0 >= 0 && i >= 0 && i < R) res[cur++] = new[] { i, c0 };

            r0 += len++;

            for (var i = c0; i > c0 - len; i--) if (r0 < R && r0 >= 0 && i >= 0 && i < C) res[cur++] = new[] { r0, i };

            c0 -= len;

            for (var i = r0; i > r0 - len; i--) if (i >= 0 && i < R && c0 >= 0 && c0 < C) res[cur++] = new[] { i, c0 };

            r0 -= len++;
        }

        return res;
    }
}
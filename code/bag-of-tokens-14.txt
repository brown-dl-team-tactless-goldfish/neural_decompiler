public class Solution 
{
    public int BagOfTokensScore(int[] tokens, int P) 
    {
        Array.Sort(tokens);
        int start = 0, end = tokens.Length - 1, score = 0, maxScore = 0;
        while(start <= end)
        {
            if(tokens[start] <= P)
            {
                P -= tokens[start];
                score++;
                start++;
            }
            else
            {
                if(score > 0)
                {
                    P += tokens[end];
                    score--;
                }
                
                end--;
            }
            
            maxScore = Math.Max(maxScore, score);
        }
        
        return maxScore;
    }
}
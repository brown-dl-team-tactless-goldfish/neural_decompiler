class Solution {
public:
    long long taskSchedulerII(vector<int>& tasks, int space) {
        map<long long,long long > m;
        
        long long days = 0;
        int N = tasks.size();
        
        for(int i = 0; i < N; i++){
            if(m[tasks[i]]){
                if(days - m[tasks[i]] < space ) days = space + m[tasks[i]] + 1;
                else days ++;
            }else{
                days ++;
            }
            
            m[tasks[i]] = days;
        }
        
        return days;
    }
};
/*get the highest 3 salaries in each department*/
with cte as (
select name,departmentId,salary,DENSE_RANK() OVER   
    (PARTITION BY e.departmentId ORDER BY e.salary DESC) as Rank from employee e 
)
/*join on department table to get the department name and filter on rank*/
select d.name as department,c.name as employee,c.salary from cto c inner join Department d on c.departmentId=d.id where c.rank<=3
class Solution {
public:
    int averageOfSubtree(TreeNode* root) {
        int cnt, sum, res; 
        return averageOfSubtree(root, cnt, sum);
    }
    
    int averageOfSubtree(TreeNode* root, int& cnt, int& sum) { 
        if (!root) { 
            cnt = sum = 0; 
            return 0;
        }
        int left_cnt = 0, left_sum = 0; 
        int left_res = averageOfSubtree(root->left, left_cnt, left_sum); 
        int right_cnt =0, right_sum = 0; 
        int right_res = averageOfSubtree(root->right, right_cnt, right_sum); 
        sum = left_sum+right_sum+root->val;
        cnt = left_cnt+right_cnt+1; 
        int res = left_res+right_res;
        if (sum/cnt == root->val) res++; 
        return res;
    }
};
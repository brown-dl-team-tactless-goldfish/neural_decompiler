class Solution {
public:
    using ll = long long;
    int countSpecialSubsequences(vector<int>& A) {
        ll dp0 = 1, dp1 = 0, dp2 = 0, mod = 1e9+7;
        //dpx denotes the number of subset ends with 'x'
        for(auto e : A) {
            if(e == 0) {
                dp0 = (dp0*2)%mod;
            } else if(e == 1) {
                dp1 = ((dp0-1)+dp1 + dp1)%mod;
            } else {
                dp2 = ((dp1 + dp2) + dp2)%mod;
            }
        }
        return dp2;
    }
};
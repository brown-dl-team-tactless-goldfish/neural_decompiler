public class Solution {
    public int LeastBricks(IList<IList<int>> wall) {
        
        if(wall == null || wall.Count == 0)
            return 0;
        
        // key: width, value: count
        Dictionary<int,int> dic = new Dictionary<int,int>();
        int m = wall.Count;
        int max = 0;
        foreach(var row in wall)
        {
            int sum = 0;
            for(int i = 0; i < row.Count - 1; i++)
            {
                sum += row[i];
                if(dic.ContainsKey(sum))
                    dic[sum]++;
                else
                    dic.Add(sum,1);
                
                max = Math.Max(max, dic[sum]);
            }    
        }
        
        return wall.Count - max;
    }
}
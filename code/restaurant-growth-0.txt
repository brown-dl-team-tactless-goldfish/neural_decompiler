with a as 
(select visited_on, sum(amount) amount
 from Customer
 group by visited_on
)
, b as (select min(visited_on) lo from customer)
, c as (
select to_char(visited_on, 'YYYY-MM-DD') as visited_on, 
sum(amount) over (order by visited_on asc range 6 PRECEDING) as amount, 
round(sum(amount) over (order by visited_on asc range 6 PRECEDING)/7,2) as average_amount
from a
)
select c.* from c, b
where to_date(c.visited_on, 'yyyy-mm-dd') >= b.lo + 6
order by visited_on asc;
class Solution {
public:
    int findMinMoves(vector<int>& machines) {
        int n = machines.size() ;
        int sum = accumulate(machines.begin(), machines.end(), 0) ;
        if(sum % n != 0)
            return -1 ;
        int k = sum/n ;
        vector<int>left(n) ;
        vector<int>right(n) ;
        left[0] = 0 ;
        right[0] = machines[0] - k ;
        
        for(int i = 1; i < n; i++){
            left[i] = -right[i-1] ;
            right[i] = machines[i] - left[i] - k ;
        }

        int ret = 0 ;
        for(int i = 0; i < n; i++){
            int out = 0 ; 
            if(left[i] > 0)
                out += left[i] ;
            if(right[i] > 0)
                out += right[i] ;
            ret = max(ret, out) ;
        }
        return ret ;
    }
};
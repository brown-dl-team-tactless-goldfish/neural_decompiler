class Solution {
public:
    vector<vector<long long>> splitPainting(vector<vector<int>>& segs) {
        sort(begin(segs), end(segs));
        vector<vector<int>> f(segs);
        vector<vector<long long>> ans;
        sort(begin(f), end(f), [](auto a, auto b) {return a[1] < b[1];});
        long long color = 0, i = 0, j = 0, n = f.size(), prev = segs[0][0];
        for (; i < n || j < n;) {
            long long t, nc;
            if (j >= n || (i < n && segs[i][0] < f[j][1])) {
                t = segs[i][0];
                nc = color + segs[i++][2];
            } else {
                t = f[j][1];
                nc = color - f[j++][2];
            }
            if (color && prev != t) ans.push_back({prev, t, color});
			prev = t;
            color = nc;
        }
        return ans;
    }
};
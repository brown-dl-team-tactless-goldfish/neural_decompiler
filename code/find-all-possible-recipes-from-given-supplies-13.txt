class Solution {
public:
  vector<string> findAllRecipes(vector<string>& r, vector<vector<string>>& i, vector<string>& s) {
    unordered_set<string>mp;
    for(auto &x: s) mp.insert(x);
    vector<string>answer;
    
    for(int j = 0; j < i.size();){
      for(int z = 0; z != i[j].size();)
        if(mp.count(i[j][z])){swap(i[j][z], i[j].back()); i[j].pop_back();}
        else break;
          
      if(i[j].empty()){
        mp.insert(r[j]);
        answer.push_back(r[j]);
        swap(r[j], r.back());
        r.pop_back();
        swap(i[j], i.back());
        i.pop_back();
        j = 0;
      }else j++;
    }
    
    return answer;
  }
};
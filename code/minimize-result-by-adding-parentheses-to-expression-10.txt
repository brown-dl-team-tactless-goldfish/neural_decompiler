class Solution {
public:
    long long eval(string s){
        string a, b, c, d;
        int flag = 1, f = 0;
        for(auto &x: s){
            if(x == '(')
                flag = 2;
            else if(x == ')')
                flag = 3;
            else if(flag == 1)
                a += x;
            else if(flag == 2){
                if(x == '+')
                    f = 1;
                else if(f == 0)
                    b += x;
                else c += x;
            }
            else d += x;
        }
        
        if(a.length() == 0 && d.length() != 0)
            return (stoi(b)+stoi(c)) * stoi(d);
        else if(a.length() != 0 && d.length() == 0)
            return (stoi(b)+stoi(c)) * stoi(a);
        else if(a.length() != 0 && d.length() != 0)
            return (stoi(b)+stoi(c)) * stoi(a) * stoi(d);
        else return (stoi(b)+stoi(c));
    }
    
    string minimizeResult(string exp) {
        string a,b;
        long long ans = INT_MAX;
        string res;
        bool flag = false;
        for(auto &x: exp){
            if(x == '+')
                flag = !flag;
            else if(!flag)
                a += x;
            else b += x;
        }
        for(int i=0; i <= a.length()-1; i++){
            string t1 = a.substr(0,i);
            string t2 = a.substr(i); 
            string temp1 = t1 + '(' + t2;
            for(int j=1; j <= b.length(); j++){
                string t1 = b.substr(0,j);
                string t2 = b.substr(j); 
                string temp2 = temp1 + '+' + t1 + ')' + t2;
                int c = eval(temp2);
                if(c < ans){
                    ans = c;
                    res = temp2;
                }
            }
        }
        return res;
    }
};
int lastRemaining(int n){
    if(n == 1)
        return 1 ;
    if(n < 4)
        return 2 ;
    int left = 2, right = n - n%2 ;
    int gap = 2 ;
    bool RightToLeft = true ;
    while((right - left) > gap){
        if(RightToLeft){
            right = right - gap ;
            gap *= 2 ;
            if((right - left) % gap != 0)
                left += gap/2 ;
            RightToLeft = false ;
        }
        else{
            left = left + gap ;
            gap *= 2 ;
            if((right - left) % gap != 0)
                right -= gap/2 ;
            RightToLeft = true ;
        }
    }
    if(RightToLeft)
        return left ;
    else
        return right ;

}
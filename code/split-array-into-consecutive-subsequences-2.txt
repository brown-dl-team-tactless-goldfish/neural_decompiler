while (nums[i] == nums[0] && i < numsSize)
{
    i++; open++;
}
int prevCount = open;
int prevVal = nums[0];

while(i<numsSize)
{
    int curVal = nums[i++], curCount=1;
    while (i < numsSize && curVal == nums[i])
    {
        i++; curCount++;
    }
    if (curCount - prevCount > 0)
    {
        for (int j = 0; j < (curCount - prevCount); j++)
			nums[open++] = curVal;
    } else if (curCount - prevCount < 0) {
        for (int j = 0; j < (prevCount - curCount); j++)
		{
			if ((prevVal - nums[close] + 1) < 3)
			{
				return false;
			}
			close++;
		}
    }
    if (curVal - prevVal != 1)
    {
        if ((prevVal - nums[close] + 1) < 3)
        {
            return false;
        }
        close++;
        nums[open++] = curVal;
    }
    prevVal = curVal;
    prevCount = curCount;
}
i = 0;
while (i<prevCount)
{
    if ((prevVal - nums[close] + 1) < 3)
    {
        return false;
    }
    close++; i++;
}
if (open != close)
    return false;
return true;
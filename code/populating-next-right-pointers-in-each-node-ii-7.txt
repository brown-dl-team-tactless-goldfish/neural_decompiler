/**
 * Definition for a Node.
 * struct Node {
 *     int val;
 *     struct Node *left;
 *     struct Node *right;
 *     struct Node *next;
 * };
 */


struct Node* connect(struct Node* root) {
    if(!root) return root;
    struct Node* head=NULL;
    struct Node* prev=NULL;
    struct Node* curr=root;
    
    while(curr!=NULL){
        while(curr!=NULL){
            if(curr->left!=NULL){
                if(head==NULL){
                    head=curr->left;
                    prev=curr->left;
                }else{
                    prev->next=curr->left;
                    prev=prev->next;
                }
            }
            if(curr->right!=NULL){
                if(head==NULL){
                    head=curr->right;
                    prev=curr->right;
                }else{
                    prev->next=curr->right;
                    prev=prev->next;
                }
            }
            curr=curr->next;
        }
        curr=head;
        prev=NULL;
        head=NULL;
    }

    return root;
}
class Solution {
public:
    int latestTimeCatchTheBus(vector<int>& buses, vector<int>& passengers, int capacity) {
        sort(begin(buses), end(buses));
        sort(begin(passengers), end(passengers));
        int res = 0, i = 0, n = passengers.size(), pre = 0;
        for(auto t : buses){
            int count=0;
            for(; i<n && count<capacity && passengers[i] <= t; i++, count++){
                int cur = passengers[i];
                if(cur-1 != pre) res = cur-1;  
                pre = cur;              
            }
            if(count<capacity && t != pre) res = t;
        }
        return res;
    }
};
class Solution {
 public:
  int countTriplets(vector<int>& A) {
    std::array<optional<int>, (1 << 16) + 1> memo = {};
    for (auto a : A) for (auto b : A) memo[a & b] = memo[a & b].value_or(0) + 1;
    return [&](int acc = 0) {
      for (auto c : A)
        for (int i = 0; i < (1 << 16); ++i)
          if (memo[i] and (c & i) == 0) acc += *memo[i];
      return acc;
    }();
  }
};
/**
 * Definition for a binary tree node.
 * struct TreeNode {
 *     int val;
 *     struct TreeNode *left;
 *     struct TreeNode *right;
 * };
 */

typedef struct TreeNode node;

typedef struct child_res {
    node *root;
    node *tail;
} child_res;

child_res flatten_rec(node *root)
{
    child_res res;
    res.root = root;
    res.tail = root;
    
    if (root == NULL)
        return res;
    
    child_res left = flatten_rec(root->left);
    child_res right = flatten_rec(root->right);
    
    root->left = NULL;
    
    if (left.root) {
        res.tail->right = left.root;
        res.tail = left.tail;
    }

    if (right.root) {
        res.tail->right = right.root;
        res.tail = right.tail;
    }
    
    return res;
}

void flatten(node *root)
{
    child_res res = flatten_rec(root);
}
int numDistinct(char *s, char *t){
    int i, j, len_s=strlen(s), len_t=strlen(t);
    long *dp_buf=(int *)calloc(len_s*2, sizeof(long)), *dp_last=dp_buf, *dp_current=dp_buf+len_s;
    for(i=0;i<len_s;i++) dp_last[i]=(i?dp_last[i-1]:0)+(t[0]==s[i]);
    for(j=1;j<len_t;j++) {
        for(i=0;i<j;i++) dp_current[i]=0;
        for(i=j;i<=len_s-(len_t-j);i++) dp_current[i]=((t[j]==s[i])?dp_last[i-1]:0)+dp_current[i-1];
        dp_last=dp_current; dp_current=(dp_current!=dp_buf)?dp_buf:(dp_buf+len_s);
    }
    i=dp_last[len_s-1]; free(dp_buf); 
    return i;
}
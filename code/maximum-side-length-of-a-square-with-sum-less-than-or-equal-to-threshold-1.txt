int maxSideLength(int** mat, int matSize, int* matColSize, int threshold){
    int ** total = (int **)malloc((matSize + 1) * sizeof(int **));
    for(int i = 0; i < matSize + 1; i++)
        total[i] = (int *)calloc(*matColSize + 1, sizeof(int));
    for(int i = 1; i <= matSize; i++)
        for(int j = 1; j <= *matColSize; j++)
            total[i][j] = total[i - 1][j] + total[i][j - 1] - total[i - 1][j - 1] + mat[i - 1][j - 1];
    int len = matSize < *matColSize ? matSize : *matColSize;
    for(int k = len; k >= 1; k--)
        for(int i = 1; i + k <= matSize; i++)
            for(int j = 1; j + k <= *matColSize; j++)
                if(total[i + k][j + k] - total[i - 1][j + k] - total[i + k][j - 1] + total[i - 1][j - 1] <= threshold)
                    return k + 1;
    return 0;
}
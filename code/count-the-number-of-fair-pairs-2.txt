class Solution {
public:
    long cnt(vector<int>v,int val){
        long ans=0;
        for(int i=0,j=v.size()-1;i<j;i++){
            while(i<j&&v[i]+v[j]>val)j--;
            ans+=j-i;
        }
        return ans;
    }
    long long countFairPairs(vector<int>& nums, int lower, int upper) {
        int n=nums.size();
        sort(nums.begin(),nums.end());
        return cnt(nums,upper)-cnt(nums,lower-1);
    }
};
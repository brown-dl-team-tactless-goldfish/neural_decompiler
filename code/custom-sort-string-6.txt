class Solution:
    def customSortString(self, S: str, T: str) -> str:
        T = list(T)

        def helper(end_idx_T, c_in_S):
            # print("end_idx_T = ", end_idx_T)
            # print("c_in_S = ", c_in_S)

            l, r = 0, end_idx_T - 1

            while (l < r):
                # print("l = ", l, " r = ", r)

                while (l < r and T[l] != c_in_S):
                    l += 1
                while (r > l and T[r] == c_in_S):
                    r -= 1

                T[l], T[r] = T[r], T[l]

            # print("end while T = ", T)
            # print("end r = ", r)
            return r

        r = len(T)
        for idx in range(len(S)-1, -1, -1):
            c = S[idx]
            # print("c = ", c)
            if (c in T):
                r = helper(r, c)

        # print("end T = ", T)
        return ''.join(T)
class Solution {
public:
    using VI = vector< int >;
    using VVI = vector< VI >;
    int maxEqualRowsAfterFlips( VVI& M, int ans=1 ){
        for( auto i{ M.begin() }; next( i ) != M.end(); ++i ){
            auto same{ 1 }; // the first row is always equal to itself
            for( auto j{ i+1 }; j != M.end(); ++j )
                if( *i == *j || *i == flip( *j ) )
                    ans = max( ans, ++same );
        }
        return ans;
    }
private:
    VI flip( VI A ){
        transform( A.begin(), A.end(), A.begin(), []( auto& x ){ return x^1; });
        return A;
    }
};
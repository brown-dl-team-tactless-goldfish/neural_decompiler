    def smallestRangeII(self, A, K):
        ma, mi = max(A), min(A)
        if ma - mi >= 4 * K: return ma - mi - 2 * K
        if ma - mi <= K: return ma - mi
        inter = sorted([i for i in A if ma - 2 * K < i < mi + 2 * K] + [ma - 2 * K, mi + 2 * K])
        return min(a + 2 * K - b for a, b in zip(inter, inter[1:]))
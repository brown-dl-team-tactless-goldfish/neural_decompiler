string decodeAtIndex(string &S, int K, long long len = 0) {
  for (auto i = 0; i < S.size(); ++i) {
    if (isalpha(S[i])) {
      if (++len == K) return string(1, S[i]);
    }
    else {
      if (len * (S[i] - '0') >= K) return decodeAtIndex(S, K % len == 0 ? len : K % len);
      len *= S[i] - '0';
    }
  }
}
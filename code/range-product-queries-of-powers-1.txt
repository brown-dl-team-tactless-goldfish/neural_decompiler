class Solution {
public:
    #define ll long long
        const int mod = 1e9+7;
    int bp(ll a, ll b){
        ll res = 1;
        while(b){
            if(b&1) res *= a;
            res %= mod;
            a *= a;
            a%=mod;
            b >>= 1;
        }
        return res;
    }
    vector<int> productQueries(int n, vector<vector<int>>& queries) {
        vector<int> check;
        for(int i = 0 ; i < 32 ; i++){
            if((n>>i)&1){
                check.push_back(1<<i);
            }
        }
        int m = check.size();
        ll presum[m];
        presum[0] = check[0];
        vector<int> ans;
        for(int i = 1 ; i < m ; i++) presum[i] = (check[i]*presum[i-1])%mod;
        for(auto x : queries){
            int l = x[0];
            int r = x[1];
            
            if(l!=0)
            ans.push_back((presum[r]*bp(presum[l-1],mod-2))%mod);
            else ans.push_back(presum[r]);
        }
        return ans;
    }
};
    lenRow = len(row)
    #print "lenRow = ", lenRow

    uf = UnionFind(lenRow)

    res = 0
    needSwapList = []
    for i in range(lenRow/2):
        idx_0, idx_1 = 2*i, 2 * i + 1
        pair_0 = row[idx_0]
        pair_1 = row[idx_1]

        # if pair_0 > pair_1:
        #     pair_0, pair_1 = pair_1, pair_0
        #     idx_0, idx_1 = idx_1, idx_0

        #print "i = ", i, " pair_0 = ", pair_0, " pair_1 = ", pair_1

        if uf.isConnected(pair_0, pair_1) == False:
            needSwapList.append(pair_0)
            needSwapList.append(pair_1)

            if pair_0 % 2 == 0:
                needData = uf.find(pair_0)
            else:
                needData = pair_0 - 1
            #print "needData = ", needData

            needIdx = row.index(needData)
            #print "needIdx = ", needIdx
            row[idx_1], row[needIdx] = row[needIdx], row[idx_1]
            res += 1

    #print "end res = ", res
    #print "needSwapList = ", needSwapList
    #print "end row = ", row

    return res
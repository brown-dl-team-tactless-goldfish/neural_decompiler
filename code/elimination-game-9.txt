        public class Solution
        {
            private void Helper(int n, int start, int diff, bool fromLeft, out int res)
            {
                if (n == 1)
                {
                    res = start;
                    return;
                }

                if (fromLeft)
                {
                    start += diff;
                }
                else
                {
                    if (n % 2 == 1)
                    {
                        start += diff;
                    }
                }

                Helper(n / 2, start, diff * 2, !fromLeft, out res);
            }

            public int LastRemaining(int n)
            {
                int res;
                Helper(n, 1, 1, true, out res);
                return res;
            }
        }
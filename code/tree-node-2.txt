SELECT id,(IF(temp.p_id IS NULL,'Root',IF(temp.c_id IS NULL,'Leaf','Inner'))) AS type FROM (SELECT id,t.p_id,c_id FROM Tree as t LEFT OUTER JOIN (SELECT p_id,id AS c_id FROM Tree GROUP BY p_id) AS c ON t.id=c.p_id) AS temp;
public class Solution {
    public int TakeCharacters(string s, int k) {
      int a = 0;
      int b = 0;
      int c = 0;

      foreach (char d in s)
        if (d == 'a')
          a += 1;
        else if (d == 'b')
          b += 1;
        else
          c += 1;

      if (a < k || b < k || c < k)
        return -1;

      int sa = 0;
      int sb = 0;
      int sc = 0;

      int result = -1;

      for (int left = 0, right = 0; right < s.Length; ++right) {
        char ch = s[right];

        if (ch == 'a')
          sa += 1;
        else if (ch == 'b')
          sb += 1;
        else
          sc += 1;

        while (sa > a - k || sb > b - k || sc > c - k) {
          ch = s[left++];
          
          if (ch == 'a')
            sa -= 1;
          else if (ch == 'b')
            sb -= 1;
          else 
            sc -= 1;
        }

        if (sa <= a - k && sb <= b - k && sc <= c - k) 
          result = Math.Max(result, right - left + 1);
      }

      return s.Length - result;
    }
}
class Solution {
public:
    int minSwaps(string s) {
        int res = 0, cnt = 0;
        for (int i = 0; i < s.size(); ++ i) {
            if (s[i] == '1') ++ cnt;
            else -- cnt;
        }
        if (abs(cnt) > 1) return -1;
        char c = '1';
        if (cnt == -1) c = '0';
        if (!cnt) {
            int tmp = 0, cnt2 = 0;
            cnt = 0;
            for (int i = 0; i < s.size(); ++ i) {
                if (s[i] != c) {
                    if (cnt) -- cnt;
                    else {
                        ++ res;
                        ++ cnt;
                    }
                }
                if (s[i] != ('1' + '0' - c)) {
                    if (cnt2) -- cnt2;
                    else {
                        ++ tmp;
                        ++ cnt2;
                    }
                }
                c = '1' - c + '0';
            }
            res = min(res, tmp);
        } else {
            cnt = 0;
            for (int i = 0; i < s.size(); ++ i) {
                if (s[i] != c) {
                    if (cnt) -- cnt;
                    else {
                        ++ res;
                        ++ cnt;
                    }
                }
                c = '1' - c + '0';
            }
        }
        return res;
    }
};
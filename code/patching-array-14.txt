class Solution {
public:
    int minPatches(vector<int>& nums, int n) {
        long long sz = nums.size(), patches = 0;
        long long lim = 0;
        for(int i = 0; i < sz; i++) {
            int mn = nums[i], mx = lim+nums[i];
            if(mn > lim+1) patches++, lim += lim+1, i--;
            else lim = mx;
            if(lim >= (long long)n) break;
        }
        
        while(lim < (long long)n) patches++, lim += lim+1;
        return patches;
    }
};
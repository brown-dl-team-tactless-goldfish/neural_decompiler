impl Solution {
    pub fn count_valid_words(sentence: String) -> i32 {
        let rule1 = |w: &str| w.bytes().all(|c| !c.is_ascii_digit());
        let rule2 = |w: &str| {
            if let Some(pos) = w.find('-') {
                0 < pos
                    && pos < w.len() - 1
                    && w.as_bytes()[pos + 1].is_ascii_lowercase()
                    && w[pos + 1..].find('-').is_none()
            } else {
                true
            }
        };
        let rule3 = |w: &str| {
            w[..w.len() - 1]
                .bytes()
                .all(|c| c != b'!' && c != b'.' && c != b',')
        };

        sentence
            .split(' ')
            .filter(|w| !w.is_empty() && rule1(w) && rule2(w) && rule3(w))
            .count() as i32
    }
}
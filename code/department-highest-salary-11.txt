WITH CTE AS (
SELECT DEPARTMENTID,NAME,SALARY,RANK() OVER(PARTITION BY DEPARTMENTID ORDER BY SALARY DESC) as r
FROM EMPLOYEE
    )
    SELECT D.NAME AS Department,C.NAME AS Employee,c.salary as Salary
    FROM CTE C JOIN DEPARTMENT D 
    ON C.DEPARTMENTID = D.ID
    where c.r=1
	```
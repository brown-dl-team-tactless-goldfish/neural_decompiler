class SnapshotArray {
public:
    explicit SnapshotArray( int _ ){ }

    void set( int i, int x ){ A[i] = x; }
    int get( int i, int id ){ return seen[id][i]; }

    int snap() {
        seen.push_back( A );
        auto N = static_cast< int >( seen.size() );
        return N - 1;
    }

private:
    using Values = unordered_map< int,int >; // "get" values not explicitly "set" default to 0
    using Seen = vector< Values >;
    Values A;
    Seen seen;
};
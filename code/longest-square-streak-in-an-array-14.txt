public class Solution 
{
    public int LongestSquareStreak(int[] nums) 
    {
        int result = -1;
        SortedSet<int> ss = new SortedSet<int>(nums);
        Array.Sort(nums);
        while(ss.Any())
        {
            int cur = ss.Min;
            ss.Remove(cur);
            int count = 1;
            while(ss.Contains(cur * cur))
            {
                ss.Remove(cur * cur);
                count++;
                cur = cur * cur;
            }
            if (count >= 2)
                result = Math.Max(result, count);
        }
        return result;
    }
}
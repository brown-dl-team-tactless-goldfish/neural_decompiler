class Solution {
public:
    int superPow(int a, vector<int>& b) {
        
        int n = b.size();
        unsigned long long ans = 1;
        unsigned long long p = a % 1337;
        
        for (int i = n-1; i >= 0; i--) {
            
            unsigned long long res = 1;
            for (int j = 0; j < b[i]; j++) {
                res = (res * p) % 1337;
            }
            
            ans = (ans * res) % 1337;
            for (int j = b[i]; j < 10; j++) {
                res = (res * p) % 1337;
            }
            
            p = res;
        }
        
        return ans;
    }
};
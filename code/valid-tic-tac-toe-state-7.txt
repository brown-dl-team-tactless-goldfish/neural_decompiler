class Solution {
public:
    bool validTicTacToe(vector<string>& board) {
        int cntX = 0;
        int cntO = 0;
        for(string s : board)
        {
            for(char c : s)
            {
                if(c == 'X') cntX++;
                else if(c == 'O') cntO++;
            }
        }
        bool XWin = (board[0] == "XXX" || board[1] == "XXX" || board[2] == "XXX"
                      ||(board[0][0] == 'X' && board[1][0] == 'X' && board[2][0] == 'X')
                      ||(board[0][1] == 'X' && board[1][1] == 'X' && board[2][1] == 'X')
                      ||(board[0][2] == 'X' && board[1][2] == 'X' && board[2][2] == 'X')
                      ||(board[0][0] == 'X' && board[1][1] == 'X' && board[2][2] == 'X')
                      ||(board[0][2] == 'X' && board[1][1] == 'X' && board[2][0] == 'X'));
        bool OWin = (board[0] == "OOO" || board[1] == "OOO" || board[2] == "OOO"
                      ||(board[0][0] == 'O' && board[1][0] == 'O' && board[2][0] == 'O')
                      ||(board[0][1] == 'O' && board[1][1] == 'O' && board[2][1] == 'O')
                      ||(board[0][2] == 'O' && board[1][2] == 'O' && board[2][2] == 'O')
                      ||(board[0][0] == 'O' && board[1][1] == 'O' && board[2][2] == 'O')
                      ||(board[0][2] == 'O' && board[1][1] == 'O' && board[2][0] == 'O'));
        if(XWin) return cntO == cntX-1;
        if(OWin) return cntO == cntX;
        return cntX == cntO || cntX-1 == cntO;
    }
};
class Solution {
public:
    int minimumDistance(string word) {
        return go(word);
    }
private:
    static constexpr char INF = -1;
    int cost(char beg, char end) {
        if (beg == INF) // first time finger used
            return 0;
        auto a = beg - 'A', // offset 'A' to 0
             b = end - 'A';
        return abs((a / 6) - (b / 6)) + abs((a % 6) - (b % 6));
    }
    using Memo = unordered_map<string, int>;
    int go(string& s, int i = 0, char one = INF, char two = INF, Memo&& memo = {}) {
        if (i == s.size())
            return 0;
        stringstream key; key << i << "," << one << "," << two;
        if (memo.find(key.str()) != memo.end())
            return memo[key.str()];
        return memo[key.str()] = min(
            cost(one, s[i]) + go(s, i + 1, s[i], two, move(memo)),
            cost(two, s[i]) + go(s, i + 1, one, s[i], move(memo))
        );
    }
};
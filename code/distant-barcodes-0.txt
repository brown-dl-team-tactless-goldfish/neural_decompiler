using PII = pair<int, int> ;
class Solution {
public:
    vector<int> rearrangeBarcodes(vector<int>& barcodes) {
        unordered_map<int, int>Map ;
        for(auto x : barcodes){
            Map[x]++ ;
        }
        priority_queue<PII, vector<PII>, less<>> pq ;
        for(auto x : Map){
            pq.push({x.second, x.first}) ;
        }
        
        vector<int>ans ;
        while(!pq.empty())
        {
            if(pq.size() == 1){
                ans.push_back(pq.top().second) ;
                pq.pop() ;
                continue ;
            }
            
            pair<int, int>tmp1 = pq.top() ;
            pq.pop() ;   
            pair<int, int>tmp2 = pq.top() ;
            pq.pop() ; 
            ans.push_back(tmp1.second) ;
            ans.push_back(tmp2.second) ;
            tmp1.first -= 1 ;
            tmp2.first -= 1 ;
            if(tmp1.first > 0)
                pq.push(tmp1) ;
            if(tmp2.first > 0)
                pq.push(tmp2) ;
        }
        return ans ;
    }
};
public class Solution 
{
    public int FindSubstringInWraproundString(string p) 
    {
        int n = p.Length, len = 1;
        if (n == 0) return 0;
        var counts = new int[128];
        counts[p[0]] = 1;
        for (int i = 1; i < n; i++) 
        {
            len = IsNext(p[i - 1], p[i]) ? len + 1 : 1;
            counts[p[i]] = Math.Max(counts[p[i]], len);
        }
        
        return counts.Sum();
    }
    
    private bool IsNext(char ch1, char ch2)
    {
        return (ch1 == 'z') ? ch2 == 'a' : ch1 + 1 == ch2; 
    }
}
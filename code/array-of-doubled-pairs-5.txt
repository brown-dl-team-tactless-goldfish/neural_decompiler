class Solution {
public:
    struct cmp {
        bool operator()(int a, int b) const {
            if (abs(a) == abs(b)) return a < b;
            else return abs(a) < abs(b);
        }
    };
    bool canReorderDoubled(vector<int>& A) {
        if (A.size() & 1) return false;
        multiset<int, cmp> m;
        for (int i : A) m.insert(i);
        while (m.size()) {
            int a = *m.begin();
            m.erase(m.begin());
            auto p = m.find(a * 2);
            if (p == m.end()) return false;
            m.erase(p);
        }
        return true;
    }
};
#define ll long long int

class Solution {
public:
    int digits(ll n){
        int d = 0;
        while(n){
            d++;
            n /= 10;
        }
        return d;
    }
    
    ll reverse(ll n){
        ll r = 0;
        while(n){
            r = 10*r + n%10;
            n /= 10;
        }
        return r;
    }
    
    bool isPalindrome(ll n){
        return n == reverse(n);
    }
    
    int superpalindromesInRange(ll n2) {
        ll n = (ll)ceil(sqrt(n2)) + 10;
        int ans = 0;
        int digit = digits(n);
        for(int d = 1; d <= digit; d++){
            ll c = d/2;
            ll m = pow(10L, c);
            ll start = (c > 0 ? pow(10L, c-1) : 0L);
            if(d&1){
                for(ll i = start; i < m; i++){
                    for(int j = 0; j < 10; j++){
                        ll num = i*m*10 + j*m + reverse(i);
                        if(num && num <= n2/num && isPalindrome(num*num)){
                            ans++;
                        }
                    }
                }
            }
            else{
                for(ll i = start; i < m; i++){
                    ll num = i*m + reverse(i);
                    if(num && num <= n2/num && isPalindrome(num*num)){
                        ans++;
                    }
                }
            }
        }
        return ans;
    }
    
    int superpalindromesInRange(string left, string right) {
        return superpalindromesInRange(atoll(right.c_str())) - superpalindromesInRange(atoll(left.c_str())-1);
    }
};
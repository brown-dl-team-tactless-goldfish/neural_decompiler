struct myhash{
    int key;
    long long day;
    UT_hash_handle hh;
};

long long taskSchedulerII(int* tasks, int tasksSize, int space){
    long long ans = 0;
    struct myhash *total = NULL;
    struct myhash *tmp = NULL;
    for(int i=0;i<tasksSize;i++){
        HASH_FIND_INT(total,&tasks[i],tmp);
        if(tmp==NULL){
            tmp = malloc(sizeof(struct myhash));
            tmp->key = tasks[i];
            tmp->day = ++ans;
            HASH_ADD_INT(total,key,tmp);
        }
        else{
            if(++ans<tmp->day+space+1)
                ans = tmp->day+space+1;
            tmp->day = ans;
        }
    }
    return ans;
}
class Solution {
public:
    vector<int> filterRestaurants(const vector<vector<int>>& restaurants, int veganFriendly, int maxPrice, int maxDistance) {
        
        map<int,set<int>> m;
        for(const auto& rest:restaurants) {
            if(veganFriendly and !rest[2]) continue;
            if(rest[3] > maxPrice)         continue;
            if(rest[4] > maxDistance)      continue;
            m[rest[1]].insert(rest[0]);
        }
        
        vector<int> res;
        for(auto itm=m.rbegin(); itm!=m.rend(); ++itm)
            for(auto its=itm->second.rbegin(); its!=itm->second.rend(); ++its)
                res.push_back(*its);
        
        return res;
    }
};
    int numSubmatrixSumTarget(vector<vector<int>>& m, int t) {
        for(auto & r : m) for(int i = 1; i < m[0].size(); i++) r[i] += r[i-1];
        
        int res = 0;
        for(int c1 = 0; c1 < m[0].size(); c1++) {
            for(int c2 = c1; c2 < m[0].size(); c2++) {
                unordered_map<int, int> map;
                map[0] = 1;
                int preSum = 0;
                for(int k = 0; k < m.size(); k++) {
                    int v = m[k][c2] - (c1 == 0 ? 0 : m[k][c1-1]);
                    preSum += v;
                    res += map[preSum-t];
                    map[preSum]++;
                }
            }
        }
        return res;
    }
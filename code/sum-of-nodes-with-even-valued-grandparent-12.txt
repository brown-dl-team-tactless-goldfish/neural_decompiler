typedef struct TreeNode TreeNode;

void gp_s(TreeNode *r, int *sum)
{
    if (!(r->val & 0x1)) {   
        TreeNode *lt = r->left, *rt = r->right;
        *sum += (lt ? (lt->left ? lt->left->val : 0) +
                      (lt->right ? lt->right->val : 0) : 0) +
                (rt ? (rt->left ? rt->left->val : 0) +
                      (rt->right ? rt->right->val : 0) : 0);
    }
}

int sumEvenGrandparent(struct TreeNode* root){
    int sum = 0, f = 0, b = 0;
    TreeNode *nodes[10000] = { NULL };
    nodes[b++] = root, gp_s(root, &sum);
    while (f < b) {
        TreeNode *r = nodes[f++];
        r->left ? nodes[b++] = r->left, gp_s(r->left, &sum) : 0;
        r->right ? nodes[b++] = r->right, gp_s(r->right, &sum) : 0;
    }
    return sum;
}
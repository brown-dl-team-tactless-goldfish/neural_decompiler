public class Solution 
{
    public string DecodeAtIndex(string S, int K) 
    {
        long N = 0;
        int i;
        for (i = 0; N < K; i++) 
            N = Char.IsDigit(S[i]) ? N * (S[i] - '0') : N + 1;
        
        i--;
        while (true)
        {
            if (Char.IsDigit(S[i])) 
            {
                N = N / (S[i] - '0');
                K = K % (int) N;
            } 
            else if (K % N == 0) 
                return S[i].ToString();
            else 
                N--;
            i--;
        }
    }
}
public class Solution {
    public int LongestWPI(int[] hours) {
        int current = 0;
        
        int[] prefixes = hours
            .Select(item => current += (item > 8 ? 1 : -1))
            .ToArray();
        
        Dictionary<int, int> dict = new();
        
        int result = 0;
        
        for (int i = 0; i < hours.Length; ++i) 
            if (prefixes[i] > 0)
                result = i + 1;
            else {
                if (dict.TryGetValue(prefixes[i] - 1, out var left))
                    result = Math.Max(result, i - left);
                
                dict.TryAdd(prefixes[i], i);
            } 
          
        return result;
    }
}
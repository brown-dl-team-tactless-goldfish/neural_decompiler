public class Solution {
    public int[] BeautifulArray(int n) {
     
        List<int> res = new List<int>(){1};
        
        while(res.Count < n)
        {
            List<int> odd = new List<int>();
            List<int> even = new List<int>();
            
            // expand an existing beautiful array to new beautiful array and double the size 
            foreach(var num in res)
            {
                // ensure all the numbers in the new beautiful array still within [1,n]
                if(2 * num - 1 <= n)
                    odd.Add(2 * num - 1);
                
                if(2 * num <= n)
                    even.Add(2 * num);
            }
            
            // use  merge rule to merge the odd and even arrays. This will double the size of the beautiful array.
            odd.AddRange(even);
            // update the result
            res = odd;
        }
        
        return res.ToArray(); 
    }
}
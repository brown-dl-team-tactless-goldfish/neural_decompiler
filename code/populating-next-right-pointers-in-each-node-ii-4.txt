struct Node* connect(struct Node* root) {
    if(root == NULL)
        return NULL;

    struct Node *first = root, *cur, *pre;
    while(first)
    {
        cur = first;
        pre = first = NULL;
        while(cur)
        {
            if(cur->left)
            {
                if(pre) pre->next = cur->left;
                else first = cur->left;

                pre = cur->left;
            }

            if(cur->right)
            {
                if(pre) pre->next = cur->right;
                else first = cur->right;

                pre = cur->right;
            }

            cur = cur->next;
        }
    }

    return root;
}
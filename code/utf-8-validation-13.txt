#define BYTE_1      128
#define BYTE_2      192
#define BYTE_3      224
#define BYTE_4      240
#define BYTE_4_MAX  247

bool validUtf8(int* data, int dataSize){
    short sDataSize = dataSize;

    char cByte = 0;
    while(sDataSize-- > 0)
    {
        if(cByte)
        {
            if(*data < BYTE_1 || *data >= BYTE_2) return false;

            cByte--;
        }
        else
        {
            if(*data > BYTE_4_MAX)
            {
                return false;
            }
            else if(*data >= BYTE_4)
            {
                cByte = 3;
            }
            else if(*data >= BYTE_3)
            {
                cByte = 2;
            }
            else if(*data >= BYTE_2)
            {
                cByte = 1;
            }
            else if(*data >= BYTE_1)
            {
                return false;
            }
/*
            else //if(*data < BYTE_1)
            {
                cByte = 0;
            }
//*/
        }

        data++;
    }
    
    return cByte == 0;
}
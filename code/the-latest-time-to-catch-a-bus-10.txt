class Solution {
public:
    int latestTimeCatchTheBus(vector<int>& buses, vector<int>& passengers, int capacity) {
        sort(buses.begin(), buses.end()) ;
        sort(passengers.begin(), passengers.end()) ;
        int busCn = buses.size() ;
        int personCn = passengers.size() ;
        int j = 0 ;
        int ret = -1 ;
        for(int i = 0; i < busCn; i++){
            int cap = capacity ;
            while(j < personCn && cap > 0 && passengers[j] <= buses[i]){
                if(j == 0 || passengers[j-1] != passengers[j] -1)
                    ret = passengers[j] -1 ;
                j++ ;
                cap-- ;
            } 
            if(cap){
                if(j == 0 || passengers[j-1] != buses[i])
                    ret = buses[i] ;
            }
        }
            
        return ret ;
    }
};
int wiggleMaxLength(int *n, int nsz)
{
  int i, j, longest = 1, seq = RESET_SEQ; // reset sequence  
  
  /* Run through the array detecting changes in sequence. */
  for (i = 0; i < nsz - 1; ++i) {
     /* Detect when increasing sequence flips to decreasing sequence. */
     if ((seq != INCREASING_SEQ && n[i] < n[i + 1]) ||
         (seq != DECREASING_SEQ && n[i] > n[i + 1])) {
         seq = n[i] < n[i + 1] ? INCREASING_SEQ : DECREASING_SEQ; // adjust the state
         longest += 1; // increment count
     }
  }
  /* Handle the empty array case.*/  
  return nsz == 0 ? nsz : longest;
}
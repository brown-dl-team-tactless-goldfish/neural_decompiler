class Solution {
public:
    int conv(int val, char end) {
        if (val == 0) return 1;
        return end == '0' ? val << 1 : (val << 1) + 1;
    }
    bool queryString(string S, int N) {
        set<int> vst;
        int windowSize = log((double) N) / log(2.0f) + 1;
        for (int i = 0; i < S.size(); i++) {
            if (S[i] == '0') continue;
            int val = 0;
            for (int j = i; j < min(i + windowSize, (int) S.size()); j++) {
                val = conv(val, S[j]);
                if (val <= N) vst.insert(val);
            }
        }
        return vst.size() >= N;
    }
};
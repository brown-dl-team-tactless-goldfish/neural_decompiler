public class Solution
{
    public string LargestMultipleOfThree(int[] digits)
    {
        int sum = 0;
        int[] arr = new int[10];
        foreach (int d in digits)
        {
            sum += d;
            arr[d]++;
        }

        if (sum % 3 == 1)
        {
            if (arr[1] + arr[4] + arr[7] >= 1)
                Reduce(arr, 1, 1);
            else
                Reduce(arr, 2, 2);
        }
        else if (sum % 3 == 2)
        {
            if (arr[2] + arr[5] + arr[8] >= 1)
                Reduce(arr, 2, 1);
            else
                Reduce(arr, 1, 2);
        }

        if (sum == 0)
            return arr[0] == 0 ? "" : "0";

        StringBuilder sb = new StringBuilder();
        for (int i = 9; i >= 0; i--)
        {
            for (int j = 0; j < arr[i]; j++)
            {
                sb.Append(i);
            }
        }

        return sb.ToString();
    }

    private void Reduce(int[] arr, int num, int cnt)
    {
        for (int i = 0; i < 3; i++)
        {
            int min = Math.Min(arr[num + i * 3], cnt);
            arr[num + i * 3] -= min;
            cnt -= min;
        }
    }
}
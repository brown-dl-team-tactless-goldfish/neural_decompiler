class Solution {
public:
    vector<int> minDifference(vector<int>& nums, vector<vector<int>>& queries) {
        int n=nums.size();
        int cnt[n][101];
        memset(cnt,0,sizeof(cnt));
        for(int i=0;i<n;i++){
            cnt[i][nums[i]]++;
        }
        for(int i=1;i<=100;i++){
            for(int j=1;j<n;j++)
            cnt[j][i]+=cnt[j-1][i];
        }
        vector<int>ans;
        for(int i=0;i<queries.size();i++){
            vector<int>hold;
            for(int j=1;j<=100;j++){
                int how=cnt[queries[i][1]][j];
                if(queries[i][0]!=0) how-=cnt[queries[i][0]-1][j];
                if(how) hold.push_back(j);
            }
            int minn=1e9;
            for(int i=1;i<hold.size();i++){
                minn=min(minn,hold[i]-hold[i-1]);
            }
            if(minn==1e9) ans.push_back(-1);
            else ans.push_back(minn);
        }
        return ans;
    }
};
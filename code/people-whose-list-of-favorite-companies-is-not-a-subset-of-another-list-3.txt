public IList<int> PeopleIndexes(IList<IList<string>> favoriteCompanies) {
    var ctoi = new Dictionary<string, List<int>>();
    for(var i = 0; i < favoriteCompanies.Count; ++i) {
        foreach(var c in favoriteCompanies[i]) {
            if (!ctoi.ContainsKey(c)) ctoi[c] = new List<int>();
            ctoi[c].Add(i);
        }
    }
    var result = new List<int>();
    var cur = new HashSet<int>();
    for(var i = 0; i < favoriteCompanies.Count; ++i) {
        cur.UnionWith(ctoi[favoriteCompanies[i][0]]);
        for(var j = 1; j < favoriteCompanies[i].Count; ++j) {
            var next = ctoi[favoriteCompanies[i][j]];
            cur.IntersectWith(next);
            if (cur.Count == 1) break;
        }
        if (cur.Count == 1)
            result.Add(cur.First());
        cur.Clear();
    }

    return result;
}
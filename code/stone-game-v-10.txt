class Solution {
public:
    int stoneGameV(vector<int>& stoneValue) {
        vector<int> sums={0};// sum of [0,i)
        vector<vector<int>> scores(stoneValue.size()+1, vector<int> (stoneValue.size()+1, -1));
        
        for( int i=0; i<stoneValue.size(); i++) sums.push_back(sums.back()+stoneValue[i]);
        
        return maxScore( sums, scores, 0, stoneValue.size());
    }
    
protected:
    int maxScore(vector<int> & sums, vector<vector<int>> & scores, int b, int e){// [b,e)
        if(b==e-1)  return 0;
        if(scores[b][e]!=-1)    return scores[b][e];
        int mx=0;
        for( int i=b+1; i<=e; i++){// [b,i) v.s. [i,e)
            int left=sums[i]-sums[b], right=sums[e]-sums[i], t;
            if(left<right){
                t=left+maxScore( sums, scores, b, i);
            }else if(right<left){
                t=right+maxScore( sums, scores, i, e);
            }else{
                int left_score=left+maxScore( sums, scores, b, i), right_score=right+maxScore( sums, scores, i, e);
                t=left_score<right_score?right_score:left_score;
            }
            mx=mx<t?t:mx;
        }
        scores[b][e]=mx;
        return mx;
    }
};
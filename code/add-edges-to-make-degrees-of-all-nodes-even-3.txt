class Solution {
public:
    bool isSafe(vector<int> &v, set<vector<int>> &s, vector<int> adj[], int n){
        if(s.find({v[0],v[1]})==s.end()){
            if(s.find({v[2],v[3]})==s.end()){
                return true;
            }
        }
        if(s.find({v[0],v[2]})==s.end()){
            if(s.find({v[1],v[3]})==s.end()){
                return true;
            }
        }
        if(s.find({v[1],v[2]})==s.end()){
            if(s.find({v[0],v[3]})==s.end()){
                return true;
            }
        }
        return false;
    }
    
    bool isPossible(int n, vector<vector<int>>& ed) {
        vector<int> inor(n,0);
        set<vector<int>> s;
        vector<int> adj[n];
        for(auto x:ed){
            inor[x[0]-1]++;
            inor[x[1]-1]++;
            adj[x[0]-1].push_back(x[1]-1);
            adj[x[1]-1].push_back(x[0]-1);
            s.insert({(x[0]-1),(x[1]-1)});
            s.insert({(x[1]-1),(x[0]-1)});
        }
        
        vector<int> v;
        
        for(int i=0;i<n;i++){
            if(inor[i]%2!=0){
                v.push_back(i);
            }
        }

        if(v.size()>4 || v.size()%2==1){
            return false;
        }
        if(v.size()==0){
            return true;
        }
        if(v.size()==2){
            if(inor[v[0]]==n-1 || inor[v[1]]==n-1){
                return false;
            }
            if(s.find({v[0],v[1]})==s.end()){
                return true;
            }
            for(int i=0;i<n;i++){
                if(i!=v[0] && i!=v[1] && inor[i]<n-2 && s.find({i,v[0]})==s.end() && s.find({i,v[1]})==s.end()){
                    return true;
                }
            }
        }
        if(v.size()==4){
            if(isSafe(v,s,adj,n)){
                return true;
            }
        }
        return false;
    }
};
//code by sachin
public class Solution
{
    SortedDictionary<int, List<int[]>> map = new();
    public IList<IList<int>> VerticalTraversal(TreeNode root)
    {
        Preorder(root, 0, 0);
        List<IList<int>> res = new();
        foreach(var kvp in map)
        {
            res.Add(kvp.Value.OrderBy(x => x[0]).ThenBy(x => x[1]).Select(x => x[1]).ToList());
        }
        return res;
    }
    private void Preorder(TreeNode root, int r, int c)
    {
        if(root == null) return;
        if(map.TryAdd(c, new List<int[]>(){new int[]{r, root.val}}) == false) map[c].Add(new int[]{r, root.val});
        
        if(root.left != null) Preorder(root.left, r + 1, c - 1);
        if(root.right != null) Preorder(root.right, r + 1, c + 1);
    }
}
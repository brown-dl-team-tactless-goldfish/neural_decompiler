    unordered_map<int,int> mp;
    
    vector<int> ans;
    
    for(auto x: barcodes)
    {
        mp[x]++;
    }
    
    priority_queue<pair<int,int>> pq;
    
    for(auto x: mp)
    {
        pq.push({x.second,x.first});
    }
    
    while(pq.size() > 1)
    {
        auto x = pq.top();
        pq.pop();
        
        auto y = pq.top();
        pq.pop();
        
        ans.push_back(x.second);
        ans.push_back(y.second);
        
        x.first--;
        y.first--;
        
        if(x.first > 0)
        {
            pq.push(x);
        }
        
        if(y.first > 0)
        {
            pq.push(y);
        }
    }
    
    if(pq.size() == 1)
    {
        ans.push_back(pq.top().second);
    }
    
    return ans;
    
}
class Solution {
public:
    int orderOfLargestPlusSign(int N, vector<vector<int>>& mines) {
        int len = 0;
        vector<set<int>> row(N), col(N);
        for (auto &v : mines) {
            row[v[0]].emplace(v[1]);
            col[v[1]].emplace(v[0]);
        }

        for (int r = 0; r < N; r++) {
            for (int c = 0; c < N; c++) {
                int row_len = maxlen(row[r], c, N); // max length of row
                int col_len = maxlen(col[c], r, N); // max length of col
                len = max(len, min(row_len, col_len));
            }
        }
        return (len + 1) / 2;
    }

    int maxlen(set<int>& s, int mid, int N) {
        auto it = s.lower_bound(mid);
        if (it != s.end() && *it == mid) return 0; // (i, j) is 0
        int end = it == s.end() ? N - 1 : *it - 1;
        int begin = it == s.begin() ? 0 : *(--it) + 1;
        int len = 2 * min(mid - begin, end - mid) + 1;
        return len;
    }
};
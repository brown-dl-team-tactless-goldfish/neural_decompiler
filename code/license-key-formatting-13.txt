char * licenseKeyFormatting(char * S, int K){
    size_t a = 0, sz, c = 0;
    char *e = S, *s, *p;
    while (*e && (a += !!isalnum(*e++), 1));
    for (a ? sz = a + a / K + !!(a % K), p = (s = calloc(1, sz)) + sz - 2 : 0 ; a && --e >= S ;)
        *e != '-' && (*p-- = toupper(*e)) && p >= s && ++c == K && (*p-- = '-', c = 0);
    return a ? s : (S[0] = 0, S);
}
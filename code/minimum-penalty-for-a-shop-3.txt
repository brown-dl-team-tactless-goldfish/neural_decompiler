public class Solution {
    public int BestClosingTime(string customers) {
        int current = customers.Count(c => c == 'N');
        
        int best = current;
        int result = customers.Length;

        for (int i = customers.Length - 1; i >= 0; --i) {
            current += customers[i] == 'Y' ? 1 : -1; 

            if (current <= best) {
                current = best;

                result = i;
            }        
        }

        return result;
    }
}
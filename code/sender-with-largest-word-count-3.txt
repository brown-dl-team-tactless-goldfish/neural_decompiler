public class Solution {
    public string LargestWordCount(string[] messages, string[] senders) {
        return senders
            .Zip(messages, (s, m) => (sender : s, words : m.Count(c => c == ' ') + 1))
            .GroupBy(p => p.sender, p => p.words)
            .Select(g => (sender : g.Key, wc : g.Sum()))
            .OrderByDescending(p => p.wc)
            .ThenByDescending(p => p.sender, StringComparer.Ordinal)
            .First()
            .sender;
    }
}
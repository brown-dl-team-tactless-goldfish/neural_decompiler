class Solution {
public:
    #define ll long long int
    int dp[4001];
    ll hash[4004],pow[4004];
    ll d=1e9+7,q=1e9+13;
    ll get(int i,int j)
    {
        return (hash[j+1]-(hash[i]*pow[j-i+1])%q+q)%q;
    }
    int find(int i,string &s)
    {
        if(i>=s.size())
            return 0;
        if(dp[i]!=-1)
            return dp[i];
        int res=1;
        for(int j=0;i+2*j+1<s.size();j++)
        {
            if(get(i,i+j)==get(i+j+1,i+2*j+1))
                res=max(res,1+find(i+j+1,s));
        }
        return dp[i]=res;
    }
    int deleteString(string s) 
    {
        pow[0]=1;
        hash[0]=0;
        int n=s.size();
        for(int i=0;i<n;i++)
        {
            hash[i+1]=((hash[i]*d)+(s[i]-'a'))%q;
            pow[i+1]=(pow[i]*d)%q;
        }
        memset(dp,-1,sizeof(dp));
        return find(0,s);
    }
};
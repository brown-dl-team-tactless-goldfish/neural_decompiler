# define M 1000000007
int cmp(const void* a, const void* b){
    return *(int*)a - *(int*)b;
}

long long POW(long long a, int b){
    a %= M ;
    if(b == 0)
        return 1 ;
    if(b == 1)
        return a ;
    
    if(b%2)
        return a*POW(a, b-1)%M ;
    
    return POW(a*a, b/2) % M ;
}

int numSubseq(int* nums, int numsSize, int target){
    int n = numsSize;
    qsort(nums, n, sizeof(int), cmp);
    long long ans = 0;
    int j = n-1 ;
    for(int i = 0; i < n; i++){
        if( nums[i]*2 > target)
            break ;
        int remain = target - nums[i] ;
        while(i < j){
            if(nums[j] > remain)
                j-- ;
            else
                break;
        }
        ans = ans + POW(2, j-i) ;
        ans %= M ;
    }
    return ans;
}
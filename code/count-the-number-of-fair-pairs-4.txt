class Solution {
public:
    long long countFairPairs(vector<int>& nums, int lower, int upper) {
        sort(nums.begin(),nums.end());
        int i=0,j=1,k=nums.size()-1;
        long long sum = 0;
        while(i<nums.size()){
            while(k>=0 && nums[i]+nums[k] > upper)
                k--;
            while(j<nums.size() && nums[i]+nums[j] < lower)
                j++;
            if(j <= k){
                sum += k-j+1;
            }
            i++,j=i+1;
        }
        return sum;
    }
};
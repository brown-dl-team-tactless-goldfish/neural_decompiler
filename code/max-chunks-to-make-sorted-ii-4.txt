class Solution {
public:
    int maxChunksToSorted(vector<int>& arr) {
        vector<int> sorted(arr.begin(), arr.end());
        sort(sorted.begin(), sorted.end());
        vector<int> less(sorted.size(), 0);
        for(int i=1;i<sorted.size();i++){
            less[i]= sorted[i]==sorted[i-1] ? less[i-1] : i;
        }
        int ret = 0;
        int maxNum=arr[0];
        int lessNum = 0;
        int i=0;
        while(i<arr.size()){
            if(arr[i] > maxNum){
                lessNum=i; 
                maxNum = arr[i];
            }else if(arr[i] < maxNum){
                lessNum++;
            }
            maxNum = max(maxNum, arr[i]);

            if(lessNum==less[i] && maxNum == sorted[i]){
                ret++;
            }
            i++;
        }
        return ret;
        
    }
};
# Write your MySQL query statement below
WITH cte1 AS (
    SELECT
        s.user_id AS user_id,
        SUM(CASE WHEN action='timeout' THEN 1 ELSE 0 END) AS timeouts,
        SUM(CASE WHEN action='confirmed' THEN 1 ELSE 0 END) AS confirmations
    FROM Signups s
    LEFT JOIN Confirmations c ON s.user_id=c.user_id
    GROUP BY s.user_id
)
SELECT
    user_id,
    (CASE WHEN confirmations=0 THEN 0.0 ELSE ROUND(confirmations/(timeouts + confirmations), 2) END)
        AS confirmation_rate
FROM cte1;
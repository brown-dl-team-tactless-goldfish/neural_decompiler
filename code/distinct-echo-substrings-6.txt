public class Solution {
    public int DistinctEchoSubstrings(string text) {
        int mod = (int)Math.Pow(10,9) + 7;
        int[,] dp = new int[text.Length+1, text.Length+1];
        HashSet<int> res = new HashSet<int>();
        for (int i = 1; i <= text.Length; i++)
        {
            for (int j = i; j <= text.Length; j++)
            {
                dp[i, j] = dp[i, j - 1] * 26 % mod + text[j - 1] - 'a' + 1;
                if (i * 2 - j - 1 >= 0 && dp[i * 2 - j - 1, i - 1] == dp[i, j])
                    res.Add(dp[i, j]);
            }
        }
        
        return res.Count;
    }
}
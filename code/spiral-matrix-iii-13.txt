class Solution {
public:
    vector<vector<int>> spiralMatrixIII(int R, int C, int r0, int c0) {
        vector<vector<int>> res {{r0, c0}};
        int dir[][2] = {{0, 1}, {1, 0}, {0, -1}, {-1, 0}};
        int d = 0;
        while (true) {
            for (int t = 2;; ++t) {
                for (int i = 0; i < (t >> 1); ++i) {
                    r0 += dir[d][0];
                    c0 += dir[d][1];
                    if (r0 >= 0 && r0 < R && c0 >= 0 && c0 < C) {
                        res.push_back({r0, c0});
                        if (res.size() >= R * C) return res;
                    }
                }
                d += 1;
                d %= 4;
                if (res.size() >= R * C) return res;
            }
        }
    }
};
select p.id , 'Root' as type from Tree p where p.p_id is null
union
select p.id , 'Inner' as type from Tree p inner join Tree c on p.id = c.p_id where p.p_id is not null 
union
select p.id, 'Leaf' as type from Tree p left outer join Tree c on p.id = c.p_id where p.p_id is not null and c.id is null
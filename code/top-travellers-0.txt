WITH cte
AS
(SELECT 
	r.user_id, 
	SUM(r.distance) AS travelled_distance
FROM Rides r
GROUP BY r.user_id)

SELECT u.name, IFNULL(travelled_distance, 0) AS travelled_distance FROM Users u
LEFT JOIN cte c ON u.id = c.user_id
GROUP BY u.id
ORDER BY travelled_distance DESC, name ASC
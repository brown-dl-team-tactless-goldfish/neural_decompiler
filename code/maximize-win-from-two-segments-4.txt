class Solution {
public:
    int maximizeWin(vector<int>& P, int k) {
        int res = 0, dp[100001]{};
        for(int i = 0, j = 0; i < P.size(); i++) {
            while(P[i]-P[j] > k) j++;
            int cnt = i - j + 1;
            res = max(res, cnt + (j > 1 ? dp[j-1] : 0));
            dp[i] = max(i > 0 ? dp[i-1] : 0, cnt);
        }
        return res;
    }
};
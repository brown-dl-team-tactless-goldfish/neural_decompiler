public class Solution 
{
    public int BalancedString(string s) 
    {
        var freq = new Dictionary<char, int>() {{'Q', 0},{'W', 0}, {'E', 0},{'R', 0}};
        int n = s.Length, res = n, i = 0;
        foreach(var ch in s)
            freq[ch]++;
        
        for (int j = 0; j < n; j++) 
        {
            freq[s[j]]--;
            while (i < n && freq.Values.Max() <= n / 4) 
            {
                res = Math.Min(res, j - i + 1);
                freq[s[i++]]++;
            }
        }
        
        return res;
    }
}
/* Write your T-SQL query statement below */


WITH base AS (

    SELECT id,visit_date, people, 
           ROW_NUMBER()OVER(ORDER BY visit_date) AS 'R'
    FROM   stadium
    WHERE people >= 100

), sequence AS (


    SELECT A.id
    FROM        base AS A 
    INNER JOIN  base AS B ON A.id =B.id-1 AND A.R=B.R-1
    INNER JOIN  base AS C ON A.id =C.id-2 AND A.R=C.R-2 AND B.id = C.id-1 AND B.R = C.R-1
)

SELECT A.id,visit_date, people
FROM        stadium  AS A 
WHERE A.id IN (SELECT id FROM sequence)

    UNION 

SELECT A.id,visit_date, people
FROM        stadium  AS A  
WHERE A.id IN (SELECT id+1 FROM sequence)

    UNION 

SELECT A.id,visit_date, people
FROM        stadium  AS A  
WHERE A.id IN (SELECT id+2 FROM sequence)

class Solution {
public:
    int longestWPI(vector<int>& hours) {
        
        int n = hours.size();
        
        unordered_map<int, int>hm;
        int c = 0, res = 0;
        hm[0] = -1;
        
        for (int i = 0; i < n; i++) {
            c = hours[i] > 8 ? c+1 : c-1;
            if (c > 0) {
                res = i+1;
            } else {
                if (hm.find(c-1) != hm.end())
                    res = max(res, i-hm[c-1]);       
                if (hm.find(c) == hm.end())
                    hm[c] = i;
            }
        }
        
        return res;
    }
};
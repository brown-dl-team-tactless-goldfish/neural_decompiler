public class Solution {
    public IList<string> WordSubsets(string[] A, string[] B) {
        List<string> res = new List<string>();
        
        // max occurence of each unique char in words in B
        int[] maxFreq = new int[26];
        foreach(string word in B)
        {
            int[] freq = new int[26];
            foreach(char c in word)
            {
                int idx = c - 'a';
                freq[idx]++;        
                maxFreq[idx] = Math.Max(maxFreq[idx], freq[idx]);
            }
        }
        
        foreach(string str in A)
        {
            // occurrence of each unique char in each word in A
            int[] freq = new int[26];
            foreach(char c in str)
                freq[c - 'a']++;
            
            // For each unique char, check if each word in A has more occurrences
            int i = 0;
            for(i = 0; i < 26; i++)
            {
                if(freq[i] < maxFreq[i])
                    break;
            }
            
            if(i == 26)
                res.Add(str);
        }
        
        return res;
    }
}
class Solution {
public:
    long long countSubarrays(vector<int>& nums, long long k) {
        
        long long start = 0, end = 0, sum = nums[0], count = 0, n = nums.size();
        
        while(start < n && end < n) {
            if(sum * (abs(end-start)+1) < k) {
                end++;   
                if (end >= start) count += end - start;
                if (end < n) sum += nums[end];
            } 
            else {
                sum -= nums[start];
                start++;
            }
        }
        
        return count;
        
    }
};```
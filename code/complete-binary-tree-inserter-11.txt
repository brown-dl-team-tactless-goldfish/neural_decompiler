public class CBTInserter {
    private TreeNode _root;
    private Queue<TreeNode> _queue = new Queue<TreeNode>();

    public CBTInserter(TreeNode root) {
        _root = root;
        _queue.Enqueue(root);
        while (true) {
            var node = _queue.Peek();
            if (node.left == null) break;
            _queue.Enqueue(node.left);
            if (node.right == null) break;
            _queue.Enqueue(node.right);
            _queue.Dequeue();
        }
    }
    
    public int Insert(int v) {
        var t = new TreeNode(v);
        var node = _queue.Peek();
        if (node.left == null) {
            node.left = t;
        } else if (node.right == null) {
            node.right = t;
            _queue.Dequeue();
        }
        _queue.Enqueue(t);
        return node.val;
    }
    
    public TreeNode Get_root() {
        return _root;
    }
}
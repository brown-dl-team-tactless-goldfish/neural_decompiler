class Solution {
public:
    int numPermsDISequence(string S) {
        int n = S.size() + 1, d = 0, i = 0;
        vector<int> arr(n, 1);
        auto func = [](int a, int b) { return (a + b) % 1000000007; };
        for (char c : S) {
            if (c == 'D') {
                ++d;
                partial_sum(arr.rbegin() + i, arr.rend() - d, arr.rbegin() + i, func);
            } else {
                ++i;
                partial_sum(arr.begin() + d, arr.end() - i, arr.begin() + d, func);
            }
        }
        return *(arr.begin() + d);
    }
};
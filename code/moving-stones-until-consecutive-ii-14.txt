	class Solution {
public:
    vector<int> numMovesStonesII(vector<int>& A) {
        int n = A.size();
        int maxcon = 1, start, end, j = 0;
        int si=0, ei=0;
        sort(A.begin(), A.end());
        for(int i = 0; i < n; i++) {
            start = A[i];
            end = start+n;
            while(j<n&&A[j]<end) {
                j++;
            }
            if(j-i>maxcon||(j-i==maxcon&&A[j-1]-A[i]>ei-si)){
                si=A[i];
                ei=A[j-1];
                maxcon=j-i;
            }
        }
        
        int minimum = n-maxcon;
        if(maxcon==n-1&&ei-si==maxcon-1) minimum++;
        if(maxcon==n) minimum=0;
        int largest_interval = max(A[n-1]-A[1], A[n-2]-A[0])-1;
        int maximum =  largest_interval-(n-3);
        return {minimum, maximum};
    }
}
```;
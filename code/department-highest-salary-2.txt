WITH combined as(
SELECT e.Id , e.Name as employee, Salary, d.Name as Department, e.DepartmentId 
FROM Employee e JOIN Department d ON e.DepartmentId=d.Id),
    
maxdep as (
SELECT DepartmentId, Max(Salary) as Salary 
FROM Employee 
GROUP BY DepartmentId
    )
    
SELECT c.Department, employee, c.Salary
FROM combined c JOIN maxdep m 
on c.DepartmentId=m.DepartmentId and c.Salary=m.Salary
select distinct p.id, 
    case when p.p_id is null then 'Root'
         when c.id is null then 'Leaf'
         else 'Inner' end as type 
from tree p left join tree c on p.id=c.p_id
order by p.id
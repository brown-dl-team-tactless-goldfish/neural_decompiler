with x as
    (select person_name, turn, 
            sum(weight) over(order by turn) as c from Queue )

select person_name from x
where c <=1000
order by turn desc
limit 1
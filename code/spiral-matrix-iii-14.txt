public class Solution {
    public int[][] SpiralMatrixIII(int R, int C, int r0, int c0) {
        
        int i = r0, j = c0, size = R * C, idx = 0, len = 0, d = 0;
        int[][] res = new int[size][];
        int[,] dirs = new int[,]{{0,1},{1,0},{0,-1},{-1,0}}; // east, south, west, north  
        res[idx++] = new int[2]{i,j};
        
        while(idx < size)
        {
            if(d == 0 || d == 2)
                len++;
            
            for(int l = 0; l < len; l++)
            {
                i += dirs[d,0];
                j += dirs[d,1];
                
                if(i >= 0 && i < R && j >= 0 && j < C)
                    res[idx++] = new int[2]{i,j};
            }
            
            d = (d + 1) % 4;
        }
               
        return res;
    }
}
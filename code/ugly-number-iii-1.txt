class Solution {
public:
    int nthUglyNumber(int n, int a, int b, int c) {
    
        int low = 1;
        int high = INT_MAX;
        
        long A = long(a); long B = long(b); long C = long(c);
        long AB = lcm(A, B);
        long AC = lcm(A, C);
        long BC = lcm(B, C);
        long ABC = lcm(A, BC);
        
        while (low < high) {
            int mid = low + (high-low)/2;
            int count = mid/A + mid/B + mid/C - mid/AB - mid/BC - mid/AC + mid/ABC;

            if (count < n)
                low = mid+1;
            else
                high = mid;
        }
        
        return low;
    }
};
class Solution {
public:
    int maxEqualRowsAfterFlips(vector<vector<int>>& matrix) {
        map<vector<int>,int> M;
        int ans = 0;
        
        for(auto v : matrix){
           M[v]++;
           for(auto & t: v){
               t = 1 - t;
           }
           M[v]++;
        }
        
        for(auto [v,k] : M){
           ans = max(ans,k);
        }
        
        return ans;
    }
};

class Solution {
public:
    vector<int> smallestSubarrays(vector<int>& nums) {
        int sz=nums.size();
        vector<vector<int>>arr(31);
        int j=0;
        // arr[i] will store the indices of values in which ith bit is on
        for(auto & ele:nums){
            for(int i=0;i<31;i++){
                if((ele>>i)&1)
                    arr[i].push_back(j);
            }
            j++;
        }
        // suf[i] will store maximum or starting at this index
        vector<int>suf=nums;
        for(int i=sz-2;i>=0;i--)
            suf[i]=nums[i]|suf[i+1];
        vector<int>ans(sz,0);
        for(int i=0;i<sz;i++){
            // assume max OR value starting at this index is "x", then we will check if "kth" bit is on or off,
            // if its on then we want to find the minimum greater index which can set its bit on,we are doing this using binary search.
            int res=1;
            for(int k=0;k<31;k++){
                if((suf[i]>>k)&1){
                    auto it=lower_bound(begin(arr[k]),end(arr[k]),i);
                    int len=(*it)-i+1;
                    res=max(res,len);
                }
            }
            ans[i]=res;
        }
        return ans;
    }
};
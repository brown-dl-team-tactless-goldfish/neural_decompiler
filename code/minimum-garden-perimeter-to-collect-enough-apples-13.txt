class Solution {
public:
    long long minimumPerimeter(long long neededApples) {
        int64_t lo{1}, hi{125993}, mid, temp;
        
        while(lo < hi) {
            mid = ((lo+hi-1)>>1)|1;
            temp = total_apples(mid);
            
            if(temp < neededApples) {
                lo = mid+2;
            } else if(temp == neededApples) {
                return (mid-1)*4;
            } else {
                hi = mid;
            }
        }
        
        return (hi-1)*4;
    }
    
    int64_t total_apples(int len) {
        int64_t half{len>>1};
        return 2 * len * (half * (half+1));
    }
};
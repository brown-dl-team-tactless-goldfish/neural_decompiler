class Solution {
public:
    typedef long long ll;
    ll big = 1e9 + 7;
    int distinctSubseqII(string s) {
        int n = s.size();
        unordered_map<char, int> last;
        vector<ll> v(n, 0);
        
        for(int i=0; i<n; ++i) {
            char ch = s[i];
            ll res = last.count(ch) ? 0 : 1;
            int l = last.count(ch) ? last[ch] : 0;
            for(int j=l; j<i; ++j) {
                res += v[j];
            }
            v[i] = res % big;
            last[ch] = i;
        }
        
        ll ans = 0;
        for(int i=0; i<n; ++i) {
            ans += v[i];
        }
        return ans % big;
    }
};
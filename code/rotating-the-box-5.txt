public class Solution {
    
    public char[][] RotateTheBox(char[][] box) {
      char[][] result = Enumerable
          .Range(0, box[0].Length)
          .Select(_ => new char[box.Length])
          .ToArray();

      for (int r = 0; r < box.Length; ++r) {
        int rr = box.Length - 1 - r;
            
        int at = box[0].Length - 1;

        for (int c = box[0].Length - 1; c >= 0; --c) {
          char letter = box[r][c];

          result[c][rr] = letter;

          if (letter == '*') 
            at = c - 1;
          else if (letter == '#') {
            result[c][rr] = '.';
            result[at--][rr] = '#';
          }
        }
      }

      return result;
    }
    
}
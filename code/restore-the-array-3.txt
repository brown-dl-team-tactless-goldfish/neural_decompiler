class Solution {
    string S;
    int K;
    vector<int> dp;
    
    int helper(int i) {
        if (i >= S.size()) return 1;
        if (S[i] == '0') return 0;
        if (dp[i] != -1) return dp[i];
        
        static const int MOD = 1e9+7;
        long long num = 0;
        long long count = 0;
        
        for (int c = i; c < S.size(); ++c) {
            num = num * 10 + (S[c] - '0');
            if (num > K) break;
            count += helper(c+1) % MOD;
        }
        
        return dp[i] = count % MOD;
    }
public:
    int numberOfArrays(string s, int k) {
        S = s;
        K = k;
        dp = vector<int>(S.size(), -1);
        return helper(0);
    }
};
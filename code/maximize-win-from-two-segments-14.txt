class Solution {
public:
    int maximizeWin(vector<int>& p, int k) {
        int n=p.size(),ans=0;
        for(int i=0,r=0,l=0,v=0;i<n;++i){
            while(r<n&&p[r]-p[i]<=k)++r;
            p[i]=r-i;
            while(p[l]+l<=i)v=max(v,p[l++]);
            ans=max(ans,l?v+p[i]:p[i]+i);
            if(r==n)return ans;
        }
        return ans;
    }
};
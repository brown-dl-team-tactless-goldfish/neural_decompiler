#define min(a,b) ((a) < (b) ? (a) : (b))

int trap(int* height, int heightSize){
    int i, j;
    int* leftHighVal = (int*)malloc(heightSize * sizeof(int));
    int* rightHighVal = (int*)malloc(heightSize * sizeof(int));
    
    leftHighVal[0] = height[0];
    rightHighVal[heightSize-1] = height[heightSize-1];
    
    for(i = 1; i < heightSize; i++ ){
        if(height[i] > leftHighVal[i-1])
            leftHighVal[i] = height[i];    
        else
            leftHighVal[i] = leftHighVal[i-1];
    }

    for(i = (heightSize-2); i >= 0; i--){
        if(height[i] > rightHighVal[i+1])
            rightHighVal[i] = height[i];    
        else
            rightHighVal[i] = rightHighVal[i+1];
    }
    
    int ans = 0;
    
    for(i = 0; i < heightSize; i++){
        ans = ans + min( leftHighVal[i], rightHighVal[i] ) - height[i];
    }
    
    free(leftHighVal);
    free(rightHighVal);
    return ans;
}
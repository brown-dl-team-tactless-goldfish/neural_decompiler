/**
 * Note: The returned array must be malloced, assume caller calls free().
 */
unsigned char toB(int * cell)
{
    unsigned char b = 0;
    for(int i=0; i<8; i++)
    {
        if(cell[i])
            b=(b<<1)|1;
        else
            b=b<<1;
    }
    return b;
}

void toD(unsigned char b, int *cell)
{
    for(int i=0; i < 8; i++)
    {
        if(b&(0b10000000>>i))
            cell[i] = 1;
        else
            cell[i] = 0;
    }
}

int* prisonAfterNDays(int* cells, int cellsSize, int n, int* returnSize){
    int *r = malloc(sizeof(int) * 8);
    
    unsigned char c = toB(cells);
    
    c = (~((c<<1)^(c>>1)))&0b01111110;
    for(int i = 0; i < (n-1)%14; i++)
        c = (~((c<<1)^(c>>1)))&0b01111110;
    
    toD(c, r);
    
    *returnSize=8;
    return r; 
}
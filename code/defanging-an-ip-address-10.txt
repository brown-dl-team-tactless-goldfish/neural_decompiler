char * defangIPaddr(char * address){
    int len = strlen(address);
    char *buf = malloc(len+1+6);
    int i, offset;
    for(i=0, offset=0; i<len; i++) {
        if (address[i] == '.') {
            buf[i+offset] = '[';
            buf[i+offset+1] = '.';
            buf[i+offset+2] = ']';
            offset += 2;
        } else {
            buf[i+offset] = address[i];
        }
    }
    buf[len+6] = '\0';
    return buf;
}
-- first step is to find the leaf and work my way down
WITH leaf as (
        SELECT
        leaf.id as leaf_id,
        leaf.p_id as lead_p_id
        FROM Tree leaf
        -- has no child
        LEFT JOIN Tree c ON (c.p_id = leaf.id)
        -- has parent
        LEFT JOIN Tree p ON (p.id = leaf.p_id)
        where c.id is null
        and p.id is not null
    )
    
, root as (


    SELECT
    id as root_id
    FROM Tree root
    WHERE root.p_id is null -- has no parent

)

SELECT 
t.id,
case 
when l.leaf_id is not null then 'Leaf'
when r.root_id is not null then 'Root'
ELSE 'Inner'
END as type
FROM Tree t 
left join leaf l ON (t.id = l.leaf_id)
left join root r ON (t.id = r.root_id);
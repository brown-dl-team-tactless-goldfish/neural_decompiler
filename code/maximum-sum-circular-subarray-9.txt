int maxSubarraySumCircular(vector<int>& a) {
    int k = a.size();
    int ret = a[0]; // 1 <= n <= 3 * 10^4
    a.insert(a.end(), a.begin(), a.end());
    a.insert(a.begin(), 0);
    deque <int> d = {0};
    for (int i = 1; i < a.size(); i++) {
        a[i] += a[i - 1];
        while (!d.empty() && d.front() < i - k)
            d.pop_front();
        ret = max(ret, a[i] - a[d.front()]);
        while (!d.empty() && a[d.back()] >= a[i])
            d.pop_back();
        d.push_back(i);
    }
    return ret;
}
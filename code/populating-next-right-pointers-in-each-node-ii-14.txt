class Solution:
    def connect(self, root: 'Node') -> 'Node':

        level_maps = {}

        def helper(curNode, curLevel):
            if (curNode == None):
                return
            helper(curNode.right, curLevel+1)

            if (curLevel not in level_maps):
                level_maps[curLevel] = [curNode]
            elif (len(level_maps[curLevel]) > 0):
                nextNode = level_maps[curLevel].pop()
                curNode.next = nextNode
                level_maps[curLevel].append(curNode)

            helper(curNode.left, curLevel+1)
        helper(root, 0)
        return root

class Solution {
    inline int onesSubstrings(int len) {
        constexpr int modulo = 1000000007;
        const auto val = (len * (len + 1ULL)) >> 1ULL;
        return static_cast<int>(val % modulo);
    }
    int onesSubstringsCount(const string &s) {
        int ret = 0;
        int subs = 0;
        for(char c : s) {
            if(c == '1') {
                ++subs;
            } else {
                if(subs) {
                    ret += onesSubstrings(subs);
                    subs = 0;
                }
            }
        }
        if(subs) {
            ret += onesSubstrings(subs);
        }
        return ret;
    }
public:
    int numSub(string s) {
        return onesSubstringsCount(s);
    }
};
class Solution {
public:
     
    long long countSubarrays(vector<int>& nums, long long k) {
        int n=nums.size();
        vector<long long> pre(n);
        pre[0]=nums[0];
        for(long long i=1;i<n;i++){
            pre[i]=nums[i]+pre[i-1];
        }
        long long x=0;
        for(long long i=0;i<n;i++){
            long long l=i,h=n-1;
            long long fac=i==0?0:pre[i-1];
            while(l<=h){
                long long m=(l+h)/2;
                if((pre[m]-fac)*(m-i+1)>=k) h=m-1;
                else l=m+1;
            }
            x+=h-i+1;
        }
        return x;
    }
};
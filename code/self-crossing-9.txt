class Solution {
public:
    bool isSelfCrossing(vector<int>& x) {
        if (x.size() < 4) return false;
        return helper(x[0], x[1], x[2], x[3], x, 3);
    }
    
    bool helper(int a, int b, int c, int d, vector<int>& x, int cur) {
        if (cur == x.size()) return false;
        if (a >= c && d >= b) return true;
        if (cur + 1 < x.size() && b == d && c - a <= x[cur+1]) return true;
        if (cur + 2 < x.size() && d >= b && c >= x[cur+1] &&  x[cur+1] >= c - a && x[cur+2] >= d - b) return true;
        return helper(b, c, d, x[cur+1], x, cur+1);
    }
};
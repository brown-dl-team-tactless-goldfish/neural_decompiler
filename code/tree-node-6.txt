select 
	n.id,
    case
        when sum(coalesce(p.id,0)) > 0 and sum(coalesce(c.id,0)) > 0 then 'Inner'
        when sum(coalesce(p.id,0)) > 0 and sum(coalesce(c.id,0)) = 0 then 'Leaf'
        else 'Root'
    end as Type
from tree n
left join tree p on p.id = n.p_id
left join tree c on c.p_id = n.id
group by n.id`
struct Node* copyRandomList(struct Node* head) {
    struct Node *nh, *tmp, *node,*nlt,*rt;
    struct hnode *ht = NULL, *hn, *nrt;
    if (!head)
        return NULL;
    tmp = head->next;
    node =  (struct Node *)malloc(sizeof(struct Node));
    node->val = head->val;
    nh = node;
    nlt = nh;
    nlt->next = tmp;
    head->next = nh;
    
    while (tmp){
        node =  (struct Node *)malloc(sizeof(struct Node));
        node->val = tmp->val;
        
        nlt = tmp->next;
        tmp->next =  node;
        node->next = nlt;
        tmp = nlt;
    }
    tmp = head;
    nlt = nh;
    //filling the random pointers
    while (nlt){
        rt = tmp->random;
        if (!rt)
            nlt->random = NULL;
        else
            nlt->random = rt->next;
        tmp = tmp->next->next;
        if (nlt->next)
            nlt = nlt->next->next;
        else
            nlt = NULL;
    }
    
    /* forming a new list and keeping back the new list */
    nlt = nh;
    tmp = head;
    while (nlt){
        if (nlt->next)
            nrt = nlt->next->next;
        else
            nrt = NULL;
        rt = tmp->next->next;
        tmp->next = rt;
        nlt->next = nrt;
        tmp = rt;
        nlt = nrt;
    }
	return nh;
}
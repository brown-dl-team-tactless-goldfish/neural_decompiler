WITH cte AS
	(SELECT product_id, 
		    MAX(change_date) over(PARTITION BY product_id) AS max_change_date, 
            new_price,
            change_date
		FROM Products p
		WHERE change_date <= '2019-08-16')

SELECT t.product_id, IFNULL(new_price, 10) AS price
FROM (SELECT DISTINCT product_id FROM products) t 
LEFT JOIN cte c ON t.product_id = c.product_id
AND c.max_change_date = c.change_date
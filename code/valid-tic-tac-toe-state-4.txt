bool validTicTacToe(char** board, int _) {
# define B board
# define isEqual(arg1, arg2, arg3)                \
    if(arg1 == arg2 && arg2 == arg3) {            \
      if (arg1 == 'X') XWon = 1;                  \
      else if (arg1 == 'O') OWon = 1;             \
      if (XWon && OWon) return false;             \   
  }

  bool XWon = false, OWon = false; 
  int cnt = 0;

  isEqual(B[0][0], B[1][1], B[2][2]);
  isEqual(B[0][2], B[1][1], B[2][0]);

  for(int i = 0, j; i < 3; i++){
    isEqual(B[i][0], B[i][1], B[i][2]);
    isEqual(B[0][i], B[1][i], B[2][i]);

    for(j = 0; j < 3; j++)
      if (B[i][j] == 'X')  cnt++;
      else if (B[i][j] == 'O') cnt--;
  }

  if (XWon) return cnt == 1;
  if (OWon) return cnt == 0;
  return cnt == 0 || cnt == 1;

#undef B
#undef equal
}
#define DEAD_CELL  0
#define ALIVE_CELL 1

int Conway_cell_logic(int **board, int r, int c, int m, int n) {
    int eight_count = 0;
    int result = board[r][c];
    if(r+1 < m)  eight_count += board[r+1][c];
    if(r-1 >= 0) eight_count += board[r-1][c];
    if(c+1 < n)  eight_count += board[r][c+1];
    if(c-1 >= 0) eight_count += board[r][c-1];
    if(r+1 < m && c+1 < n)   eight_count += board[r+1][c+1];
    if(r+1 < m && c-1 >= 0)  eight_count += board[r+1][c-1];
    if(r-1 >= 0 && c+1 < n)  eight_count += board[r-1][c+1];
    if(r-1 >= 0 && c-1 >= 0) eight_count += board[r-1][c-1];
    
    if(eight_count < 2) {
        if(board[r][c] == ALIVE_CELL) {
            result = DEAD_CELL;
        }
    }
    else if(eight_count == 3) {
        if(board[r][c] == DEAD_CELL) {
            // Alive the dead cell
            result = ALIVE_CELL;
        }
    }
    else if(eight_count > 3) {
        result = DEAD_CELL;
    }

    return result;
}

void gameOfLife(int **board, int boardSize, int *boardColSize) {
    // Copy the board
    int **board_copy = malloc(sizeof(int *)*boardSize);
    for(int i=0;i<boardSize;i++) {
        board_copy[i] = malloc(sizeof(int)*(*boardColSize));
        memcpy(board_copy[i], &board[i][0], sizeof(int)*(*boardColSize));
    }

    for(int i=0;i<boardSize;i++) {
        for(int j=0;j<*boardColSize;j++) {
            board[i][j] = Conway_cell_logic(board_copy, i, j, boardSize, *boardColSize);
        }
    }

    free(board_copy);
}
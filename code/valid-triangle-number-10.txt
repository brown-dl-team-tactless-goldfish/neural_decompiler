class Solution {
public:
  int triangleNumber(vector<int>& nums) {
    int answer = 0;
    map<int, int>mp;
    for(auto &x: nums) 
      if(x) mp[x]++;
    
    map<int, int>::iterator it1 = mp.begin(), it2, it3;
    
    for(; it1 != mp.end(); it1++){
      int a = it1->first, na = it1->second;
      if(na > 2)                answer += na*(na-1)*(na-2) / 6;
      
      it2 = it1;    
      for(++it2 ; it2 != mp.end(); it2++){
        int b = it2->first, nb = it2->second;
        if(na > 1 && a + a > b) answer += nb*na*(na-1) / 2;
        if(nb > 1)              answer += na*nb*(nb-1) / 2;
        
        it3 = it2;
        for(++it3 ; it3 != mp.end(); it3++){
          int c = it3->first, nc = it3->second;
          if(a + b > c)         answer += na*nb*nc; 
          else break;
        }
      }
    }
    
    return answer;
  }
};
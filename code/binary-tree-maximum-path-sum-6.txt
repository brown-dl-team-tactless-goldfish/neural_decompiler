typedef struct TreeNode tree_node, *tree_node_ptr;

int dfs_max(tree_node_ptr root);

int res;
int maxPathSum(struct TreeNode* root)
{
	res = INT_MIN;
	dfs_max(root);
	return res;
}

int dfs_max(tree_node_ptr root)
{
	if (!root) return 0;
	int left_max = dfs_max(root->left),
		right_max = dfs_max(root->right), cur;
	res = fmax(res, (cur = left_max + right_max + root->val));
	return fmax(cur - fmin(left_max, right_max), 0);
}
with cte as (
select distinct player_id ,  event_date  ,

	dense_rank() over(partition by player_id order by event_date ) as d from Activity
  order by player_id,event_date)

select round(count(distinct c.player_id)/(select count(distinct player_id) from activity),2) as fraction  

from cte c join Activity a
on c.player_id = a.player_id and c.event_date =(date_add(a.event_date,
														interval 1 day))
														and d=2

With CTE_1 AS
(
select id, Email, ROW_NUMBER() OVER (PARTITION BY EMAIL order by id) as RowNum
    from Person
)
DELETE P FROM Person P INNER JOIN CTE_1 C on P.id=c.id WHERE C.RowNum>1
public class Solution {
    
    bool IsValidToken(string token){
        
        int hyphenCount = 0;
        
        for(int i = 0; i < token.Length; i++){
            switch(token[i]){
                case '!' : case '.' : case ',':
                    if( i != token.Length - 1) return false;
                    break;
                case '-':
                    if( (hyphenCount > 0) || (i == 0) || (i == token.Length - 1) || !char.IsLetter(token[i-1]) || !char.IsLetter(token[i+1]) )  return false;
                    hyphenCount ++;
                    break;
                case '0': case '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':
                    return false;
                    break;
            }
        }
        return true;
    }
    
    public int CountValidWords(string sentence) {       
        
        return sentence.Split(' ', StringSplitOptions.RemoveEmptyEntries).Count(x => IsValidToken(x) );
    }
}
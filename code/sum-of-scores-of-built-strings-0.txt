class Solution {
public:
    long long sumScores(string s) {
        vector<int> nums(s.size(),0);
        int i=0,l=0,r=0; long long re=s.size();
        for(i=1; i<s.size();++i){
            if(l<=i && i<=r){
                nums[i] = min(nums[i-l],r-i+1);
            }
            while(i+nums[i]<s.size() && s[nums[i]]==s[i+nums[i]]) nums[i]++;
            if(i+nums[i]-1>r){
                l = i; r = i+nums[i]-1;
            }
            re+=nums[i];
        }
        return re;
    }
};
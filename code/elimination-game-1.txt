int lastRemaining(int n) {
    int ans = 1, direct = 0, cnt = n, step = 1;
    while(cnt > 1) {
        ans = (direct % 2 != 0 && cnt % 2 == 0) ? ans : ans + step;
        direct++; cnt /= 2; step *= 2;
    }
    return ans;
}
    public int[] ArrayRankTransform(int[] arr) {
    
        // clone and sort the original array
        int[] arr2 = (int[])arr.Clone();  
        Array.Sort(arr2);
        
        // get rank of each number
        Dictionary<int, int> dic = new Dictionary<int, int>();        
        int rank = 1;
        foreach(int num in arr2)
        {
            if(!dic.ContainsKey(num))
                dic.Add(num, rank++);
        }
        
        // fill in result
        int[] res = new int[arr.Length];
        for(int i = 0; i < arr.Length; i++)
            res[i] = dic[arr[i]];
      
        return res;
    }
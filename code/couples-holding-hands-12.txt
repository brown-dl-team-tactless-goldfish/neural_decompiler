class Solution {
public:
    int minSwapsCouples(vector<int>& row) {
        auto idx = row;
        for(int i = 0; i < row.size(); i++)
            idx[row[i]] = i;
        
        int ans = 0;
        for(int i = 0; i < row.size(); i+=2)
        {
            if(row[i]/2 == row[i+1]/2) continue;
            ans++;
            int tgt = row[i]/2*2;
            if(tgt == row[i]) tgt += 1;
            int swp = row[i+1];
            int tgt_idx = idx[tgt];
            idx[row[i+1]] = tgt_idx;
            idx[tgt] = i+1;
            row[idx[row[i+1]]] = row[i+1];
            row[i+1] = tgt;
        }
        
        return ans;
    }
};
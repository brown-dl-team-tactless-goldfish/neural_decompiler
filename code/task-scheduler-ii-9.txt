class Solution {
public:
    #define ll long long
    long long taskSchedulerII(vector<int>& tasks, int space) 
    {
        ll d=1;
        unordered_map<ll,ll>m;
        for(auto &x:tasks)
        {
            if(m.find(x)!=m.end())
            {
                ll diff=d-m[x];
                if(diff<=space)
                    d+=(space-diff+1);
            }
            m[x]=d++;
        }
        return --d;
    }
};
class Solution {
public:
    int res = 0;
    
    void help(vector<string>& words, vector<int> letters, vector<int>& score, int curr, int idx)
    {
        if(idx == words.size())
        {
            res = max(res, curr);
            return;
        }
        
        bool flag = true;
        int tmp = 0;
        vector<int> orig = letters;
        for(auto c : words[idx])
        {
            if(letters[c-'a'] == 0)
            {
                flag = false;
                break;
            }
            letters[c-'a']--;
            tmp += score[c-'a'];
        }
        
        if(flag)
        {
            curr += tmp;
            help(words, letters, score, curr, idx+1);
        }
        
        help(words, orig, score, flag ? curr - tmp : curr, idx+1);
        
    }
    
    int maxScoreWords(vector<string>& words, vector<char>& letters, vector<int>& score) {
        vector<int> cnt(26, 0);
        for(auto c : letters)
            ++cnt[c-'a'];
        
        help(words, cnt, score, 0, 0);
        return res;
    }
};
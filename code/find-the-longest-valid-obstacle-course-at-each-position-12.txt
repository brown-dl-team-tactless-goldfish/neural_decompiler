// OJ: https://leetcode.com/contest/weekly-contest-253/problems/find-the-longest-valid-obstacle-course-at-each-position/
// Author: github.com/lzl124631x
// Time: O(NlogN)
// Space: O(1)
class Solution {
public:
    vector<int> longestObstacleCourseAtEachPosition(vector<int>& A) {
        vector<int> ans;
        int len = 0;
        for (int n : A) {
            int i = upper_bound(begin(A), begin(A) + len, n) - begin(A); // this number `n` should be put at `lis[i]`
            A[i] = n;
            len = max(i + 1, len); // updating the length of LIS
            ans.push_back(i + 1);
        }
        return ans;
    }
};
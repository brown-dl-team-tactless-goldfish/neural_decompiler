class Solution {
public:
    #define ll long long
    vector<ll>p,h;
    ll d=256,q=1e9+13;
    void build_hash(string &s)
    {
        ll n=s.size();
        h.resize(n+1,0);
        p.resize(n+1,1);
        for(int i=0;i<n;i++)
        {
            h[i+1]=(h[i]*d+s[i])%q;
            p[i+1]=(p[i]*d)%q;
        }
    }
    ll get(int i,int j)
    {
        ll res=h[j+1]-(h[i]*p[j-i+1])%q;
        if(res<0)
            res+=q;
        return res;                                                                                                                                                                
    }
    long long sumScores(string s) 
    {
        build_hash(s);
        ll res=0,n=s.size();
        for(int i=0;i<n;i++)
        {
            int l=1,h=n-i,curr=0;
            while(l<=h)
            {
                int mid=(l+h)/2;
                if(get(0,mid-1)==get(i,i+mid-1))
                {
                    curr=mid;
                    l=mid+1;
                }
                else
                    h=mid-1;
            }
            res+=curr;
        }
        return res;
    }
};
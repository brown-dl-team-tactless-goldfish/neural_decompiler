vector<int> numMovesStonesII(vector<int>& s) {
    sort(s.begin(), s.end());
    int n = s.size(), gaps = s[n - 1] - s[0] + 1 - n, low = INT_MAX;
    if (s[1] - s[0] == gaps + 1 || s[n - 1] - s[n - 2] == gaps + 1)
        low = min(2, gaps);
    else for (int i = 0; i < n; i++) // window slides here
        low = min<int>(low, n - (upper_bound(s.begin() + i, s.end(), s[i] + n - 1) - s.begin() - i));
    return {low, max(s[n - 1] - s[1], s[n - 2] - s[0]) - n + 2};
}
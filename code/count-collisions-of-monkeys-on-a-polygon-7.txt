class Solution {
public:
    int monkeyMove(int n) {
        long mod = 1e9+7;
        unordered_map<int, long> dp;
        function<long(int)> pow2 = [&](int t)->long {
            if(t == 1) return 2;
            if(dp.find(t) != dp.end()) return dp[t];
            return dp[t] = (((t%2)+1)*pow2(t/2)*pow2(t/2))%mod;
        };
        return (pow2(n) -2+mod)%mod;
    }
};
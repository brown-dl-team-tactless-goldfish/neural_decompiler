public class Solution {
    public IList<string> AlertNames(string[] keyName, string[] keyTime) 
    {
        var map = new Dictionary<String,List<int>>();
        var rst = new List<String>();
        for(int i = 0; i<keyName.Length;i++)
        {
            if(!map.ContainsKey(keyName[i]))
            {
                map[keyName[i]] = new List<int>();
            }
            map[keyName[i]].Add(ConvertToMinutes(keyTime[i]));
        }
        foreach(String name in map.Keys)
        {
            if(isValid(map[name]))
            {
                rst.Add(name);
            }
        }
        rst.Sort();
        return rst;
    }
    
    private bool isValid(List<int> times)
    {
        if(times.Count() < 3)
        {
            return false;
        }
        times.Sort();
        for(int i = 2; i<times.Count();i++)
        {
            if(times[i] - times[i-2] <=60)
            {
               return true;
            }
        }
        return false;
     }
    
     private int ConvertToMinutes(string time)
     {
        var arr = time.Split(":");
        return (int.Parse(arr[0]) * 60) + int.Parse(arr[1]);
     }
}

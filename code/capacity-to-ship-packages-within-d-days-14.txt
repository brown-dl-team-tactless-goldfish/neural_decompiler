public int ShipWithinDays(int[] weights, int D)
{
	var totalWeight = weights.Sum();
	var maxWeight = weights.Max();
	var capacity = totalWeight % D == 0 ? totalWeight / D : totalWeight / D + 1;
	capacity = capacity > maxWeight ? capacity : maxWeight;

	while (true)
	{
		var remaining = capacity;
		var day = 0;

		for (var i = 0; i < weights.Length; i++)
		{
			remaining -= weights[i];

			if (remaining < 0)
				i--;

			if (remaining <= 0)
			{
				day++;
				if (day > D || i == weights.Length - 1) break;
				remaining = capacity;
			}
		}

		if (remaining > 0)
			day++;

		if (day <= D)
			return capacity;

		capacity++;
	}
}
int numSubarrayBoundedMax(vector<int>& A, int L, int R) {
    int x = 0, y = 0, z = 0;
    for (int a : A)
        z += (++x *= a <= R) - (++y *= a < L);
    return z;
}
long long countFairPairs(vector<int>& a, int lower, int upper) {
        
        long long ans = 0;
        
        sort(a.begin(), a.end());
        
        int n = a.size();
        
        int idx = 0;
        
        for(auto val:a){
            
            int i = idx+1;
            int j = n-1;
            int l = -1;
            int r = -1;
            
            while(i<=j){//first getting the lowest number
                
                int mid = i + (j-i)/2;
                long v = (long)val + (long)a[mid];
                
                if(v>=lower && v<=upper){
                    l = mid;
                    j = mid-1;
                }else if(v>upper)
                    j = mid-1;
                else
                    i = mid+1;
                
            }
            
            i = 0;
            j = n-1;
            
            while(i<=j){//getting the largest number
                
                int mid = i + (j-i)/2;
                long v = (long)val + (long)a[mid];
                
                if(v>=lower && v<=upper){
                    r = mid;
                    i = mid+1;
                }else if(v<lower)
                    i = mid+1;
                else
                    j = mid-1;
                    
            }
            
            if(l>=idx && r>=idx)
                ans += r-l+1;
            
            idx++;
        }
        
        return ans;
    }
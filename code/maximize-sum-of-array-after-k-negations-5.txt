int i = 0, sum = 0;

qsort(nums, n, sizeof(int), compare);

while (k > 0 && i < n)  // flip the smallest negative numbers
{
    if (nums[i] < 0)
    {
        nums[i] = - nums[i];
        i ++;
    }
    else break;
    
    k--;
}

qsort(nums, n, sizeof(int), compare);   //rearrange the array

if (k % 2 == 1) nums[0] = - nums[0];    // flip the smallest number

for (i = 0; i < n; i ++)
    sum += nums[i];

return sum;
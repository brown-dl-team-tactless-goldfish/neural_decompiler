class Solution {
public:
    vector<vector<char>> rotateTheBox(vector<vector<char>>& box) {
        int m = box.size();
        int n = box[0].size();
        vector<vector<char>> ans(n, vector<char>(m));
        for(int r = 0;r<m;r++){
            for(int c = n-1; c>=0;c--){ // handle from bottom
                int nr = c, nc = m-1-r;
                ans[nr][nc] = box[r][c];
                if(ans[nr][nc] == '*' || ans[nr][nc] == '.') continue;
                
                for(nr++;nr<n && ans[nr][nc]=='.';nr++) // if empty buttom
                    swap(ans[nr][nc], ans[nr-1][nc]);
            }
        }
        return ans;
        
    }
};
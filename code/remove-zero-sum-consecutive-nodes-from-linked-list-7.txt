struct ListNode *p1;
struct ListNode *p2;
struct ListNode *testa;
struct ListNode *prec;
struct ListNode *to_free;

int flag;
int zero;

testa = NULL;
prec = NULL;
p1 = head;

while(p1 != NULL){
    flag = false;
    p2 = p1;
    zero = 0;
    
    while(p2!=NULL){
        zero += p2->val;
        if(zero == 0){
            flag = true;
            p2 = p2->next;
            while(p1 != p2){
                 to_free = p1;
                if(p1 == testa)
                    testa = NULL;
                
                p1 = p1->next;
                free(to_free);
                to_free = NULL;
            }
                
            if(testa == NULL){
               testa = p1;
                prec = testa;
            }else{
                prec->next = p2;
            }

        }else
            p2 = p2->next;
    }
    if(testa == NULL){
         testa = p1;
         prec = testa;
     }         
    if(flag != true){
        prec = p1;
        p1 = p1->next;   
    }   
}  
return testa;
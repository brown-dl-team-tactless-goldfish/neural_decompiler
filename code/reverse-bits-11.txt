    for (i = 0; i < 16; i++) {
        if (((n >> i) & 1) != ((n >> (31 - i)) & 1)) {
            n ^= ((uint32_t)1 << i);
            n ^= ((uint32_t)1 << (31-i));
        }
    }
}

return n;
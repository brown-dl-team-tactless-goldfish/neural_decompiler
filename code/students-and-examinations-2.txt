

# CTE is to normalize the subject with students
with cte as (
select * from Students ,Subjects
)
select 
c.student_id,
c.student_name, 
c.subject_name, 
sum(case when e.student_id is not null then 1 else 0 end) as attended_exams
from 
cte c left outer join Examinations e 
on c.student_id=e.student_id and c.subject_name=e.subject_name
group by c.student_id,c.student_name, c.subject_name
order by c.student_id, c.subject_name
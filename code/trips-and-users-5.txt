;WITH Total AS
(
    SELECT   
        t.Request_at,
        COUNT(*) AS [Count]
    FROM Trips t
    INNER JOIN Users c ON c.Users_Id = t.Client_Id AND c.Banned = 'No'
    INNER JOIN Users d ON d.Users_Id = t.Driver_Id AND d.Banned = 'No'
    WHERE t.Request_at BETWEEN '2013-10-01' AND '2013-10-03'
    GROUP BY t.Request_at
)
SELECT 
    t.Request_at AS [Day],
    ROUND(CAST(Cancelled.[Count] AS FLOAT)/CAST(t.[Count] AS FLOAT), 2) AS [Cancellation Rate]
FROM
(
    SELECT   
        t.Request_at,
        COUNT(*) AS [Count]
    FROM Trips t
    INNER JOIN Users c ON c.Users_Id = t.Client_Id AND c.Banned = 'No'
    INNER JOIN Users d ON d.Users_Id = t.Driver_Id AND d.Banned = 'No'
    WHERE t.Status != 'completed' AND t.Request_at BETWEEN '2013-10-01' AND '2013-10-03'
    GROUP BY ALL t.Request_at
) AS Cancelled
INNER JOIN Total t ON t.Request_at = Cancelled.Request_at
ORDER BY t.Request_at
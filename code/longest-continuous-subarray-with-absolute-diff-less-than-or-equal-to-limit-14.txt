class Solution {
public:
    int longestSubarray(vector<int>& nums, int limit) {
        deque<int> max;
        deque<int> min;
        int i = 0;
        int j;
        for(j = 0; j < nums.size(); j++){
            while(!max.empty() && nums[j] > max.back()) max.pop_back();
            while(!min.empty() && nums[j] < min.back()) min.pop_back();
            min.push_back(nums[j]);
            max.push_back(nums[j]);
            if(max.front() - min.front() > limit){
                if(max.front() == nums[i])
                    max.pop_front();
                if(min.front() == nums[i])
                    min.pop_front();
                i++;
            }
        }
        return j - i;
    }
};
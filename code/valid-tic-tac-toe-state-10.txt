class Solution {
public:
    bool validTicTacToe(vector<string>& board) {
        bool xWin = check(board, 'X'), oWin = check(board, 'O');
        int x =0, o = 0;
        for(int i=0; i<3; i++)
        {
            for(int j=0; j<3; j++)
            {
                if(board[i][j] == 'X') x++;
                else if(board[i][j] == 'O') o++;
            }
        }
        
        if(xWin) return !oWin && x - o == 1;
        else if(oWin) return x == o;
        return x - o == 0 || x - o == 1;
    }
    
    bool check(vector<string>& board, char c)
    {
        return (board[0][0] == c && board[0][1] == c && board[0][2] == c)
            || (board[1][0] == c && board[1][1] == c && board[1][2] == c)
            || (board[2][0] == c && board[2][1] == c && board[2][2] == c)
            || (board[0][0] == c && board[1][0] == c && board[2][0] == c)
            || (board[0][1] == c && board[1][1] == c && board[2][1] == c)
            || (board[0][2] == c && board[1][2] == c && board[2][2] == c)
            || (board[0][0] == c && board[1][1] == c && board[2][2] == c)
            || (board[0][2] == c && board[1][1] == c && board[2][0] == c);
    }
};
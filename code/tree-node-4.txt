select distinct p.id, case when p.p_id is null then 'Root'
    when c.p_id is null and p.p_id is not null then 'Leaf'
    else 'Inner' end as type
from Tree p left join Tree c on p.id = c.p_id
order by p.id